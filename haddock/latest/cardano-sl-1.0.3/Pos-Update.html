<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Pos.Update</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Pos-Update.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Pos.Update.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">cardano-sl-1.0.3: Cardano SL main implementation</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Pos.Update</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Whole Update System in one module :)</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short">module <a href="../cardano-sl-update-1.0.3/Pos-Update-Context.html">Pos.Update.Context</a></li><li class="src short">module <a href="../cardano-sl-update-1.0.3/Pos-Update-Core.html">Pos.Update.Core</a></li><li class="src short"><a href="#v:installerHash">installerHash</a> :: LByteString -&gt; <a href="../cardano-sl-core-1.0.3/Pos-Crypto-Hashing.html#t:Hash">Hash</a> <a href="../cardano-sl-core-1.0.3/Pos-Binary-Class-Primitive.html#t:Raw">Raw</a></li><li class="src short"><a href="#v:downloadUpdate">downloadUpdate</a> :: <span class="keyword">forall</span> ctx m. <a href="../cardano-sl-update-1.0.3/Pos-Update-Mode.html#t:UpdateMode">UpdateMode</a> ctx m =&gt; <a href="../cardano-sl-update-1.0.3/Pos-Update-Poll-Types.html#t:ConfirmedProposalState">ConfirmedProposalState</a> -&gt; m ()</li><li class="src short">module <a href="../cardano-sl-update-1.0.3/Pos-Update-Logic.html">Pos.Update.Logic</a></li><li class="src short">module <a href="../cardano-sl-update-1.0.3/Pos-Update-Lrc.html">Pos.Update.Lrc</a></li><li class="src short">module <a href="../cardano-sl-update-1.0.3/Pos-Update-MemState.html">Pos.Update.MemState</a></li><li class="src short"><a href="#v:usRelays">usRelays</a> :: <span class="keyword">forall</span> ctx m. <a href="../cardano-sl-update-1.0.3/Pos-Update-Mode.html#t:UpdateMode">UpdateMode</a> ctx m =&gt; [<a href="../cardano-sl-infra-1.0.3/Pos-Communication-Relay-Class.html#t:Relay">Relay</a> m]</li><li class="src short">module <a href="../cardano-sl-update-1.0.3/Pos-Update-Params.html">Pos.Update.Params</a></li><li class="src short">module <a href="../cardano-sl-update-1.0.3/Pos-Update-Poll.html">Pos.Update.Poll</a></li><li class="src short"><a href="#v:usWorkers">usWorkers</a> :: <a href="Pos-WorkMode-Class.html#t:WorkMode">WorkMode</a> ssc ctx m =&gt; ([<a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:WorkerSpec">WorkerSpec</a> m], <a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:OutSpecs">OutSpecs</a>)</li><li class="src short"><a href="#v:updateTriggerWorker">updateTriggerWorker</a> :: <a href="Pos-WorkMode-Class.html#t:WorkMode">WorkMode</a> ssc ctx m =&gt; ([<a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:WorkerSpec">WorkerSpec</a> m], <a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:OutSpecs">OutSpecs</a>)</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src">module <a href="../cardano-sl-update-1.0.3/Pos-Update-Context.html">Pos.Update.Context</a></p></div><div class="top"><p class="src">module <a href="../cardano-sl-update-1.0.3/Pos-Update-Core.html">Pos.Update.Core</a></p></div><div class="top"><p class="src"><a id="v:installerHash" class="def">installerHash</a> :: LByteString -&gt; <a href="../cardano-sl-core-1.0.3/Pos-Crypto-Hashing.html#t:Hash">Hash</a> <a href="../cardano-sl-core-1.0.3/Pos-Binary-Class-Primitive.html#t:Raw">Raw</a> <a href="src/Pos.Update.Download.html#installerHash" class="link">Source</a> <a href="#v:installerHash" class="selflink">#</a></p><div class="doc"><p>Compute hash of installer, this is hash is <code><a href="../cardano-sl-update-1.0.3/Pos-Update-Core-Types.html#v:udPkgHash">udPkgHash</a></code> from <code><a href="../cardano-sl-update-1.0.3/Pos-Update-Core-Types.html#t:UpdateData">UpdateData</a></code>.</p><p>NB: we compute it by first CBOR-encoding it and then applying hash
 function, which is a bit strange, but it's done for historical
 reasons.</p></div></div><div class="top"><p class="src"><a id="v:downloadUpdate" class="def">downloadUpdate</a> :: <span class="keyword">forall</span> ctx m. <a href="../cardano-sl-update-1.0.3/Pos-Update-Mode.html#t:UpdateMode">UpdateMode</a> ctx m =&gt; <a href="../cardano-sl-update-1.0.3/Pos-Update-Poll-Types.html#t:ConfirmedProposalState">ConfirmedProposalState</a> -&gt; m () <a href="src/Pos.Update.Download.html#downloadUpdate" class="link">Source</a> <a href="#v:downloadUpdate" class="selflink">#</a></p><div class="doc"><p>Download a software update for given <code><a href="../cardano-sl-update-1.0.3/Pos-Update-Poll-Types.html#t:ConfirmedProposalState">ConfirmedProposalState</a></code> and
 put it into a variable which holds <code><a href="../cardano-sl-update-1.0.3/Pos-Update-Poll-Types.html#t:ConfirmedProposalState">ConfirmedProposalState</a></code> of
 downloaded update.
 Parallel downloads aren't supported, so this function may blocks.
 If we have already downloaded an update successfully, this function won't
 download new updates.</p><p>The caller must ensure that:
 1. This update is for our software.
 2. This update is for our system (according to system tag).
 3. This update brings newer software version than our current version.</p></div></div><div class="top"><p class="src">module <a href="../cardano-sl-update-1.0.3/Pos-Update-Logic.html">Pos.Update.Logic</a></p></div><div class="top"><p class="src">module <a href="../cardano-sl-update-1.0.3/Pos-Update-Lrc.html">Pos.Update.Lrc</a></p></div><div class="top"><p class="src">module <a href="../cardano-sl-update-1.0.3/Pos-Update-MemState.html">Pos.Update.MemState</a></p></div><div class="top"><p class="src"><a id="v:usRelays" class="def">usRelays</a> :: <span class="keyword">forall</span> ctx m. <a href="../cardano-sl-update-1.0.3/Pos-Update-Mode.html#t:UpdateMode">UpdateMode</a> ctx m =&gt; [<a href="../cardano-sl-infra-1.0.3/Pos-Communication-Relay-Class.html#t:Relay">Relay</a> m] <a href="src/Pos.Update.Network.Listeners.html#usRelays" class="link">Source</a> <a href="#v:usRelays" class="selflink">#</a></p><div class="doc"><p>Relays for data related to update system</p></div></div><div class="top"><p class="src">module <a href="../cardano-sl-update-1.0.3/Pos-Update-Params.html">Pos.Update.Params</a></p></div><div class="top"><p class="src">module <a href="../cardano-sl-update-1.0.3/Pos-Update-Poll.html">Pos.Update.Poll</a></p></div><div class="top"><p class="src"><a id="v:usWorkers" class="def">usWorkers</a> :: <a href="Pos-WorkMode-Class.html#t:WorkMode">WorkMode</a> ssc ctx m =&gt; ([<a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:WorkerSpec">WorkerSpec</a> m], <a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:OutSpecs">OutSpecs</a>) <a href="src/Pos.Update.Worker.html#usWorkers" class="link">Source</a> <a href="#v:usWorkers" class="selflink">#</a></p><div class="doc"><p>Update System related workers.</p></div></div><div class="top"><p class="src"><a id="v:updateTriggerWorker" class="def">updateTriggerWorker</a> :: <a href="Pos-WorkMode-Class.html#t:WorkMode">WorkMode</a> ssc ctx m =&gt; ([<a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:WorkerSpec">WorkerSpec</a> m], <a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:OutSpecs">OutSpecs</a>) <a href="src/Pos.Update.Worker.html#updateTriggerWorker" class="link">Source</a> <a href="#v:updateTriggerWorker" class="selflink">#</a></p><div class="doc"><p>This worker is just waiting until we download an update for our
 application. When an update is downloaded, it shuts the system
 down. It should be used in there is no high-level code which shuts
 down the system (e. g. in regular node w/o wallet or in explorer).</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.3</p></div></body></html>