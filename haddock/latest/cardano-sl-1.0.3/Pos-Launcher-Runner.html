<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Pos.Launcher.Runner</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Pos-Launcher-Runner.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Pos.Launcher.Runner.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">cardano-sl-1.0.3: Cardano SL main implementation</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Pos.Launcher.Runner</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">High level runners</a></li><li><a href="#g:2">Exported for custom usage in CLI utils</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Runners in various modes.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:runRealMode">runRealMode</a> :: <span class="keyword">forall</span> ssc ctx a. (<a href="../cardano-sl-ssc-1.0.3/Pos-Ssc-Class.html#t:SscConstraint">SscConstraint</a> ssc, <a href="Pos-WorkMode-Class.html#t:WorkMode">WorkMode</a> ssc ctx (<a href="Pos-WorkMode.html#t:RealMode">RealMode</a> ssc)) =&gt; <a href="Pos-Launcher-Resource.html#t:NodeResources">NodeResources</a> ssc (<a href="Pos-WorkMode.html#t:RealMode">RealMode</a> ssc) -&gt; (<a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:ActionSpec">ActionSpec</a> (<a href="Pos-WorkMode.html#t:RealMode">RealMode</a> ssc) a, <a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:OutSpecs">OutSpecs</a>) -&gt; Production a</li><li class="src short"><a href="#v:runRealBasedMode">runRealBasedMode</a> :: <span class="keyword">forall</span> ssc ctx m a. (<a href="../cardano-sl-ssc-1.0.3/Pos-Ssc-Class.html#t:SscConstraint">SscConstraint</a> ssc, <a href="Pos-WorkMode-Class.html#t:WorkMode">WorkMode</a> ssc ctx m) =&gt; (<span class="keyword">forall</span> b. m b -&gt; <a href="Pos-WorkMode.html#t:RealMode">RealMode</a> ssc b) -&gt; (<span class="keyword">forall</span> b. <a href="Pos-WorkMode.html#t:RealMode">RealMode</a> ssc b -&gt; m b) -&gt; <a href="Pos-Launcher-Resource.html#t:NodeResources">NodeResources</a> ssc m -&gt; (<a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:ActionSpec">ActionSpec</a> m a, <a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:OutSpecs">OutSpecs</a>) -&gt; Production a</li><li class="src short"><a href="#v:runServer">runServer</a> :: <span class="keyword">forall</span> m t b. (<a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m, MonadMockable m, <a href="../base-4.9.1.0/Control-Monad-Fix.html#t:MonadFix">MonadFix</a> m, WithLogger m, <a href="../cardano-sl-core-1.0.3/Pos-Core-Configuration.html#t:HasConfiguration">HasConfiguration</a>, <a href="../cardano-sl-update-1.0.3/Pos-Update-Configuration.html#t:HasUpdateConfiguration">HasUpdateConfiguration</a>, <a href="Pos-Configuration.html#t:HasNodeConfiguration">HasNodeConfiguration</a>) =&gt; (m (Statistics m) -&gt; NodeEndPoint m) -&gt; (m (Statistics m) -&gt; ReceiveDelay m) -&gt; (<a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:EnqueueMsg">EnqueueMsg</a> m -&gt; <a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:MkListeners">MkListeners</a> m) -&gt; <a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:OutSpecs">OutSpecs</a> -&gt; (Node m -&gt; m t) -&gt; (t -&gt; m ()) -&gt; <a href="Pos-Launcher-Runner.html#t:OQ">OQ</a> m -&gt; <a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:ActionSpec">ActionSpec</a> m b -&gt; m b</li><li class="src short"><span class="keyword">type</span> <a href="#t:OQ">OQ</a> m = OutboundQ (<a href="Pos-Util-OutboundQueue.html#t:EnqueuedConversation">EnqueuedConversation</a> m) <a href="../cardano-sl-infra-1.0.3/Pos-Network-Types.html#t:NodeId">NodeId</a> <a href="../cardano-sl-infra-1.0.3/Pos-Network-Types.html#t:Bucket">Bucket</a></li><li class="src short"><a href="#v:initQueue">initQueue</a> :: (<a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m, WithLogger m, FormatMsg msg) =&gt; <a href="../cardano-sl-infra-1.0.3/Pos-Network-Types.html#t:NetworkConfig">NetworkConfig</a> kademlia -&gt; <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> Store -&gt; m (OutboundQ msg <a href="../cardano-sl-infra-1.0.3/Pos-Network-Types.html#t:NodeId">NodeId</a> <a href="../cardano-sl-infra-1.0.3/Pos-Network-Types.html#t:Bucket">Bucket</a>)</li></ul></div><div id="interface"><h1 id="g:1">High level runners</h1><div class="top"><p class="src"><a id="v:runRealMode" class="def">runRealMode</a> :: <span class="keyword">forall</span> ssc ctx a. (<a href="../cardano-sl-ssc-1.0.3/Pos-Ssc-Class.html#t:SscConstraint">SscConstraint</a> ssc, <a href="Pos-WorkMode-Class.html#t:WorkMode">WorkMode</a> ssc ctx (<a href="Pos-WorkMode.html#t:RealMode">RealMode</a> ssc)) =&gt; <a href="Pos-Launcher-Resource.html#t:NodeResources">NodeResources</a> ssc (<a href="Pos-WorkMode.html#t:RealMode">RealMode</a> ssc) -&gt; (<a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:ActionSpec">ActionSpec</a> (<a href="Pos-WorkMode.html#t:RealMode">RealMode</a> ssc) a, <a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:OutSpecs">OutSpecs</a>) -&gt; Production a <a href="src/Pos.Launcher.Runner.html#runRealMode" class="link">Source</a> <a href="#v:runRealMode" class="selflink">#</a></p><div class="doc"><p>Run activity in <code><a href="Pos-WorkMode.html#t:RealMode">RealMode</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:runRealBasedMode" class="def">runRealBasedMode</a> :: <span class="keyword">forall</span> ssc ctx m a. (<a href="../cardano-sl-ssc-1.0.3/Pos-Ssc-Class.html#t:SscConstraint">SscConstraint</a> ssc, <a href="Pos-WorkMode-Class.html#t:WorkMode">WorkMode</a> ssc ctx m) =&gt; (<span class="keyword">forall</span> b. m b -&gt; <a href="Pos-WorkMode.html#t:RealMode">RealMode</a> ssc b) -&gt; (<span class="keyword">forall</span> b. <a href="Pos-WorkMode.html#t:RealMode">RealMode</a> ssc b -&gt; m b) -&gt; <a href="Pos-Launcher-Resource.html#t:NodeResources">NodeResources</a> ssc m -&gt; (<a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:ActionSpec">ActionSpec</a> m a, <a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:OutSpecs">OutSpecs</a>) -&gt; Production a <a href="src/Pos.Launcher.Runner.html#runRealBasedMode" class="link">Source</a> <a href="#v:runRealBasedMode" class="selflink">#</a></p><div class="doc"><p>Run activity in something convertible to <code><a href="Pos-WorkMode.html#t:RealMode">RealMode</a></code> and back.</p></div></div><h1 id="g:2">Exported for custom usage in CLI utils</h1><div class="top"><p class="src"><a id="v:runServer" class="def">runServer</a> :: <span class="keyword">forall</span> m t b. (<a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m, MonadMockable m, <a href="../base-4.9.1.0/Control-Monad-Fix.html#t:MonadFix">MonadFix</a> m, WithLogger m, <a href="../cardano-sl-core-1.0.3/Pos-Core-Configuration.html#t:HasConfiguration">HasConfiguration</a>, <a href="../cardano-sl-update-1.0.3/Pos-Update-Configuration.html#t:HasUpdateConfiguration">HasUpdateConfiguration</a>, <a href="Pos-Configuration.html#t:HasNodeConfiguration">HasNodeConfiguration</a>) =&gt; (m (Statistics m) -&gt; NodeEndPoint m) -&gt; (m (Statistics m) -&gt; ReceiveDelay m) -&gt; (<a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:EnqueueMsg">EnqueueMsg</a> m -&gt; <a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:MkListeners">MkListeners</a> m) -&gt; <a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:OutSpecs">OutSpecs</a> -&gt; (Node m -&gt; m t) -&gt; (t -&gt; m ()) -&gt; <a href="Pos-Launcher-Runner.html#t:OQ">OQ</a> m -&gt; <a href="../cardano-sl-infra-1.0.3/Pos-Communication-Types-Protocol.html#t:ActionSpec">ActionSpec</a> m b -&gt; m b <a href="src/Pos.Launcher.Runner.html#runServer" class="link">Source</a> <a href="#v:runServer" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:OQ" class="def">OQ</a> m = OutboundQ (<a href="Pos-Util-OutboundQueue.html#t:EnqueuedConversation">EnqueuedConversation</a> m) <a href="../cardano-sl-infra-1.0.3/Pos-Network-Types.html#t:NodeId">NodeId</a> <a href="../cardano-sl-infra-1.0.3/Pos-Network-Types.html#t:Bucket">Bucket</a> <a href="src/Pos.Util.OutboundQueue.html#OQ" class="link">Source</a> <a href="#t:OQ" class="selflink">#</a></p><div class="doc"><p>Specialization of OutboundQ for use in cardano-sl. Peers are identified
 by <code><a href="../cardano-sl-infra-1.0.3/Pos-Network-Types.html#t:NodeId">NodeId</a></code> and the data to be enqueued is an 'EnqueuedConversation m'.</p></div></div><div class="top"><p class="src"><a id="v:initQueue" class="def">initQueue</a> <a href="#v:initQueue" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m, WithLogger m, FormatMsg msg)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="../cardano-sl-infra-1.0.3/Pos-Network-Types.html#t:NetworkConfig">NetworkConfig</a> kademlia</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> Store</td><td class="doc"><p>EKG store (if used)</p></td></tr><tr><td class="src">-&gt; m (OutboundQ msg <a href="../cardano-sl-infra-1.0.3/Pos-Network-Types.html#t:NodeId">NodeId</a> <a href="../cardano-sl-infra-1.0.3/Pos-Network-Types.html#t:Bucket">Bucket</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Initialize the outbound queue based on the network configuration</p><p>We add all statically known peers to the queue, so that we know to send
 messages to those peers. This is relevant only for core nodes and
 auxx. In the former case, those core nodes will in turn add this
 core node to <em>their</em> outbound queue because this node would equally be
 a statically known peer; in the latter case, auxx is not expected
 to receive any messages so messages in the reverse direction don't matter.</p><p>For behind NAT nodes and Kademlia nodes (P2P or traditional) we start
 (elsewhere) specialized workers that add peers to the queue and subscribe
 to (some of) those peers.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.3</p></div></body></html>