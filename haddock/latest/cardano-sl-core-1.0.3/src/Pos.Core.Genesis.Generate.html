<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | Generation of genesis data for testnet.</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Genesis</span><span class="hs-operator">.</span><span class="hs-identifier">Generate</span><span>
</span><a name="line-4"></a><span>       </span><span class="hs-special">(</span><span> </span><a href="Pos.Core.Genesis.Generate.html#GeneratedGenesisData"><span class="hs-identifier hs-type">GeneratedGenesisData</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-5"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Core.Genesis.Generate.html#GeneratedSecrets"><span class="hs-identifier hs-type">GeneratedSecrets</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-6"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Core.Genesis.Generate.html#generateSecrets"><span class="hs-identifier hs-var">generateSecrets</span></a><span>
</span><a name="line-7"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Core.Genesis.Generate.html#generateFakeAvvm"><span class="hs-identifier hs-var">generateFakeAvvm</span></a><span>
</span><a name="line-8"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Core.Genesis.Generate.html#generateGenesisData"><span class="hs-identifier hs-var">generateGenesisData</span></a><span>
</span><a name="line-9"></a><span>       </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Universum</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">Random</span><span>                           </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadRandom</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">getRandomBytes</span><span class="hs-special">)</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">HashMap</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span>                     </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">HM</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span>                         </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Serokell</span><span class="hs-operator">.</span><span class="hs-identifier">Util</span><span class="hs-operator">.</span><span class="hs-identifier">Verify</span><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">VerificationRes</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>                                                          </span><span class="hs-identifier hs-var">formatAllErrors</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">verifyGeneric</span><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Binary.Class.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Binary</span><span class="hs-operator">.</span><span class="hs-identifier">Class</span></a><span>                        </span><span class="hs-special">(</span><a href="Pos.Binary.Class.Primitive.html#asBinary"><span class="hs-identifier hs-var">asBinary</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Binary.Class.Primitive.html#serialize%27"><span class="hs-identifier hs-var">serialize'</span></a><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Binary.Core.Address.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Binary</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Address</span></a><span>                 </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Core.Address.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Address</span></a><span>                        </span><span class="hs-special">(</span><a href="Pos.Core.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>                                                          </span><a href="Pos.Core.Address.html#IsBootstrapEraAddr"><span class="hs-identifier hs-type">IsBootstrapEraAddr</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>                                                          </span><a href="Pos.Core.Address.html#addressHash"><span class="hs-identifier hs-var">addressHash</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Core.Address.html#deriveLvl2KeyPair"><span class="hs-identifier hs-var">deriveLvl2KeyPair</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>                                                          </span><a href="Pos.Core.Address.html#makePubKeyAddressBoot"><span class="hs-identifier hs-var">makePubKeyAddressBoot</span></a><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Core.Coin.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Coin</span></a><span>                           </span><span class="hs-special">(</span><a href="Pos.Core.Coin.html#coinPortionToDouble"><span class="hs-identifier hs-var">coinPortionToDouble</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Core.Types.html#mkCoin"><span class="hs-identifier hs-var">mkCoin</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>                                                          </span><a href="Pos.Core.Coin.html#unsafeIntegerToCoin"><span class="hs-identifier hs-var">unsafeIntegerToCoin</span></a><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Core.Configuration.BlockVersionData.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Configuration</span><span class="hs-operator">.</span><span class="hs-identifier">BlockVersionData</span></a><span> </span><span class="hs-special">(</span><a href="Pos.Core.Configuration.BlockVersionData.html#HasGenesisBlockVersionData"><span class="hs-identifier hs-type">HasGenesisBlockVersionData</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>                                                          </span><a href="Pos.Core.Configuration.BlockVersionData.html#genesisBlockVersionData"><span class="hs-identifier hs-var">genesisBlockVersionData</span></a><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Core.Configuration.Protocol.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Configuration</span><span class="hs-operator">.</span><span class="hs-identifier">Protocol</span></a><span>         </span><span class="hs-special">(</span><a href="Pos.Core.Configuration.Protocol.html#HasProtocolConstants"><span class="hs-identifier hs-type">HasProtocolConstants</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Core.Configuration.Protocol.html#vssMaxTTL"><span class="hs-identifier hs-var">vssMaxTTL</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>                                                          </span><a href="Pos.Core.Configuration.Protocol.html#vssMinTTL"><span class="hs-identifier hs-var">vssMinTTL</span></a><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Pos.Core.Genesis.Constants.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Genesis</span><span class="hs-operator">.</span><span class="hs-identifier">Constants</span></a><span>              </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Const</span><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Core.Genesis.Types.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Genesis</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>                  </span><span class="hs-special">(</span><a href="Pos.Core.Genesis.Types.html#FakeAvvmOptions"><span class="hs-identifier hs-type">FakeAvvmOptions</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>                                                          </span><a href="Pos.Core.Genesis.Types.html#GenesisAvvmBalances"><span class="hs-identifier hs-type">GenesisAvvmBalances</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>                                                          </span><a href="Pos.Core.Genesis.Types.html#GenesisInitializer"><span class="hs-identifier hs-type">GenesisInitializer</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>                                                          </span><a href="Pos.Core.Genesis.Types.html#GenesisNonAvvmBalances"><span class="hs-identifier hs-type">GenesisNonAvvmBalances</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>                                                          </span><a href="Pos.Core.Genesis.Types.html#GenesisVssCertificatesMap"><span class="hs-identifier hs-type">GenesisVssCertificatesMap</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>                                                          </span><a href="Pos.Core.Genesis.Types.html#GenesisWStakeholders"><span class="hs-identifier hs-type">GenesisWStakeholders</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>                                                          </span><a href="Pos.Core.Genesis.Types.html#TestnetBalanceOptions"><span class="hs-identifier hs-type">TestnetBalanceOptions</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>                                                          </span><a href="Pos.Core.Genesis.Types.html#TestnetDistribution"><span class="hs-identifier hs-type">TestnetDistribution</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Core.Types.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>                          </span><span class="hs-special">(</span><a href="Pos.Core.Types.html#BlockVersionData"><span class="hs-identifier hs-type">BlockVersionData</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">bvdMpcThd</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>                                                          </span><a href="Pos.Core.Types.html#Coin"><span class="hs-identifier hs-type">Coin</span></a><span class="hs-special">)</span><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Core.Vss.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Vss</span></a><span>                            </span><span class="hs-special">(</span><a href="Pos.Core.Vss.Types.html#VssCertificate"><span class="hs-identifier hs-type">VssCertificate</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>                                                          </span><a href="Pos.Core.Vss.html#mkVssCertificate"><span class="hs-identifier hs-var">mkVssCertificate</span></a><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Crypto.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Crypto</span></a><span>                              </span><span class="hs-special">(</span><a href="Pos.Crypto.Signing.Types.Safe.html#EncryptedSecretKey"><span class="hs-identifier hs-type">EncryptedSecretKey</span></a><span class="hs-special">,</span><span>
</span><a name="line-45"></a><span>                                                          </span><a href="Pos.Crypto.Signing.Types.Redeem.html#RedeemPublicKey"><span class="hs-identifier hs-type">RedeemPublicKey</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.Signing.Types.Signing.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span>                                                          </span><a href="Pos.Crypto.HD.html#ShouldCheckPassphrase"><span class="hs-identifier hs-type">ShouldCheckPassphrase</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>                                                          </span><a href="Pos.Crypto.SecretSharing.html#VssKeyPair"><span class="hs-identifier hs-type">VssKeyPair</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.Random.html#deterministic"><span class="hs-identifier hs-var">deterministic</span></a><span class="hs-special">,</span><span>
</span><a name="line-48"></a><span>                                                          </span><a href="Pos.Crypto.Signing.Types.Safe.html#emptyPassphrase"><span class="hs-identifier hs-var">emptyPassphrase</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.Signing.Signing.html#keyGen"><span class="hs-identifier hs-var">keyGen</span></a><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>                                                          </span><a href="Pos.Crypto.Random.html#randomNumberInRange"><span class="hs-identifier hs-var">randomNumberInRange</span></a><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span>                                                          </span><a href="Pos.Crypto.Signing.Redeem.html#redeemDeterministicKeyGen"><span class="hs-identifier hs-var">redeemDeterministicKeyGen</span></a><span class="hs-special">,</span><span>
</span><a name="line-51"></a><span>                                                          </span><a href="Pos.Crypto.Signing.Safe.html#safeKeyGen"><span class="hs-identifier hs-var">safeKeyGen</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.Signing.Types.Signing.html#toPublic"><span class="hs-identifier hs-var">toPublic</span></a><span class="hs-special">,</span><span>
</span><a name="line-52"></a><span>                                                          </span><a href="Pos.Crypto.SecretSharing.html#toVssPublicKey"><span class="hs-identifier hs-var">toVssPublicKey</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.SecretSharing.html#vssKeyGen"><span class="hs-identifier hs-var">vssKeyGen</span></a><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-comment">-- | Data generated by @genTestnetOrMainnetData@ using genesis-spec.</span><span>
</span><a name="line-55"></a><span class="hs-keyword">data</span><span> </span><a name="GeneratedGenesisData"><a href="Pos.Core.Genesis.Generate.html#GeneratedGenesisData"><span class="hs-identifier">GeneratedGenesisData</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="GeneratedGenesisData"><a href="Pos.Core.Genesis.Generate.html#GeneratedGenesisData"><span class="hs-identifier">GeneratedGenesisData</span></a></a><span>
</span><a name="line-56"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="ggdNonAvvm"><a href="Pos.Core.Genesis.Generate.html#ggdNonAvvm"><span class="hs-identifier">ggdNonAvvm</span></a></a><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Pos.Core.Genesis.Types.html#GenesisNonAvvmBalances"><span class="hs-identifier hs-type">GenesisNonAvvmBalances</span></a><span>
</span><a name="line-57"></a><span>    </span><span class="hs-comment">-- ^ Non-avvm balances</span><span>
</span><a name="line-58"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="ggdAvvm"><a href="Pos.Core.Genesis.Generate.html#ggdAvvm"><span class="hs-identifier">ggdAvvm</span></a></a><span>             </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Pos.Core.Genesis.Types.html#GenesisAvvmBalances"><span class="hs-identifier hs-type">GenesisAvvmBalances</span></a><span>
</span><a name="line-59"></a><span>    </span><span class="hs-comment">-- ^ Avvm balances</span><span>
</span><a name="line-60"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="ggdBootStakeholders"><a href="Pos.Core.Genesis.Generate.html#ggdBootStakeholders"><span class="hs-identifier">ggdBootStakeholders</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Pos.Core.Genesis.Types.html#GenesisWStakeholders"><span class="hs-identifier hs-type">GenesisWStakeholders</span></a><span>
</span><a name="line-61"></a><span>    </span><span class="hs-comment">-- ^ Set of boot stakeholders (richmen addresses or custom addresses)</span><span>
</span><a name="line-62"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="ggdVssCerts"><a href="Pos.Core.Genesis.Generate.html#ggdVssCerts"><span class="hs-identifier">ggdVssCerts</span></a></a><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Pos.Core.Genesis.Types.html#GenesisVssCertificatesMap"><span class="hs-identifier hs-type">GenesisVssCertificatesMap</span></a><span>
</span><a name="line-63"></a><span>    </span><span class="hs-comment">-- ^ Genesis vss data (vss certs of richmen)</span><span>
</span><a name="line-64"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="ggdSecrets"><a href="Pos.Core.Genesis.Generate.html#ggdSecrets"><span class="hs-identifier">ggdSecrets</span></a></a><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Pos.Core.Genesis.Generate.html#GeneratedSecrets"><span class="hs-identifier hs-type">GeneratedSecrets</span></a><span class="hs-special">)</span><span>
</span><a name="line-65"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-keyword">data</span><span> </span><a name="GeneratedSecrets"><a href="Pos.Core.Genesis.Generate.html#GeneratedSecrets"><span class="hs-identifier">GeneratedSecrets</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="GeneratedSecrets"><a href="Pos.Core.Genesis.Generate.html#GeneratedSecrets"><span class="hs-identifier">GeneratedSecrets</span></a></a><span>
</span><a name="line-68"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="gsSecretKeys"><a href="Pos.Core.Genesis.Generate.html#gsSecretKeys"><span class="hs-identifier">gsSecretKeys</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Pos.Crypto.Signing.Types.Signing.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.Signing.Types.Safe.html#EncryptedSecretKey"><span class="hs-identifier hs-type">EncryptedSecretKey</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.SecretSharing.html#VssKeyPair"><span class="hs-identifier hs-type">VssKeyPair</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-69"></a><span>    </span><span class="hs-comment">-- ^ Secret keys for non avvm addresses</span><span>
</span><a name="line-70"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="gsFakeAvvmSeeds"><a href="Pos.Core.Genesis.Generate.html#gsFakeAvvmSeeds"><span class="hs-identifier">gsFakeAvvmSeeds</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">]</span><span>
</span><a name="line-71"></a><span>    </span><span class="hs-comment">-- ^ Fake avvm seeds (needed only for testnet)</span><span>
</span><a name="line-72"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-identifier">generateGenesisData</span><span>
</span><a name="line-75"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Pos.Core.Configuration.Protocol.html#HasProtocolConstants"><span class="hs-identifier hs-type">HasProtocolConstants</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Core.Configuration.BlockVersionData.html#HasGenesisBlockVersionData"><span class="hs-identifier hs-type">HasGenesisBlockVersionData</span></a><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Pos.Core.Genesis.Types.html#GenesisInitializer"><span class="hs-identifier hs-type">GenesisInitializer</span></a><span>
</span><a name="line-77"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-78"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pos.Core.Genesis.Generate.html#GeneratedGenesisData"><span class="hs-identifier hs-type">GeneratedGenesisData</span></a><span>
</span><a name="line-79"></a><a name="generateGenesisData"><a href="Pos.Core.Genesis.Generate.html#generateGenesisData"><span class="hs-identifier">generateGenesisData</span></a></a><span> </span><span class="hs-special">(</span><a href="Pos.Core.Genesis.Types.html#TestnetInitializer"><span class="hs-identifier hs-var">TestnetInitializer</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680602579"><a href="#local-6989586621680602579"><span class="hs-identifier">maxTnBalance</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Crypto.Random.html#deterministic"><span class="hs-identifier hs-var">deterministic</span></a><span> </span><span class="hs-special">(</span><a href="Pos.Binary.Class.Primitive.html#serialize%27"><span class="hs-identifier hs-var">serialize'</span></a><span> </span><a href="#local-6989586621680602578"><span class="hs-identifier hs-var">tiSeed</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-80"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a href="Pos.Core.Genesis.Types.html#TestnetBalanceOptions"><span class="hs-identifier hs-var">TestnetBalanceOptions</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680602575"><span class="hs-identifier hs-var">tiTestBalance</span></a><span>
</span><a name="line-81"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621680602585"><a href="#local-6989586621680602585"><span class="hs-identifier">fakeAvvmDistr</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680602586"><a href="#local-6989586621680602586"><span class="hs-identifier">seeds</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680602587"><a href="#local-6989586621680602587"><span class="hs-identifier">fakeAvvmBalance</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Pos.Core.Genesis.Generate.html#generateFakeAvvmGenesis"><span class="hs-identifier hs-var">generateFakeAvvmGenesis</span></a><span> </span><a href="#local-6989586621680602576"><span class="hs-identifier hs-var">tiFakeAvvmBalance</span></a><span>
</span><a name="line-82"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621680602588"><a href="#local-6989586621680602588"><span class="hs-identifier">richmenList</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680602589"><a href="#local-6989586621680602589"><span class="hs-identifier">poorsList</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a name="line-83"></a><span>        </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">replicateM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621680602581"><span class="hs-identifier hs-var">tboRichmen</span></a><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span>                           </span><span class="hs-special">(</span><a href="Pos.Core.Genesis.Generate.html#generateSecretsAndAddress"><span class="hs-identifier hs-var">generateSecretsAndAddress</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621680602584"><span class="hs-identifier hs-var">tboUseHDAddresses</span></a><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>            </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">replicateM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621680602580"><span class="hs-identifier hs-var">tboPoors</span></a><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>                           </span><span class="hs-special">(</span><a href="Pos.Core.Genesis.Generate.html#generateSecretsAndAddress"><span class="hs-identifier hs-var">generateSecretsAndAddress</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621680602584"><span class="hs-identifier hs-var">tboUseHDAddresses</span></a><span class="hs-special">)</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680602590"><a href="#local-6989586621680602590"><span class="hs-identifier">richSkVssCerts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621680602599"><a href="#local-6989586621680602599"><span class="hs-identifier">sk</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621680602600"><a href="#local-6989586621680602600"><span class="hs-identifier">vc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680602599"><span class="hs-identifier hs-var">sk</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680602600"><span class="hs-identifier hs-var">vc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621680602588"><span class="hs-identifier hs-var">richmenList</span></a><span>
</span><a name="line-89"></a><span>        </span><a name="local-6989586621680602591"><a href="#local-6989586621680602591"><span class="hs-identifier">secretKeys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621680602601"><a href="#local-6989586621680602601"><span class="hs-identifier">sk</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680602602"><a href="#local-6989586621680602602"><span class="hs-identifier">hdwSk</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680602603"><a href="#local-6989586621680602603"><span class="hs-identifier">vssSk</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680602601"><span class="hs-identifier hs-var">sk</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680602602"><span class="hs-identifier hs-var">hdwSk</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680602603"><span class="hs-identifier hs-var">vssSk</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-90"></a><span>                         </span><span class="hs-special">(</span><a href="#local-6989586621680602588"><span class="hs-identifier hs-var">richmenList</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621680602589"><span class="hs-identifier hs-var">poorsList</span></a><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span>        </span><a name="local-6989586621680602592"><a href="#local-6989586621680602592"><span class="hs-identifier">safeZip</span></a></a><span> </span><a name="local-6989586621680602604"><a href="#local-6989586621680602604"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621680602605"><a href="#local-6989586621680602605"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621680602606"><a href="#local-6989586621680602606"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-93"></a><span>            </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621680602605"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621680602606"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-94"></a><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621680602604"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; :lists differ in size, &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621680602605"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span>
</span><a name="line-95"></a><span>                         </span><span class="hs-string">&quot; and &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621680602606"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621680602605"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621680602606"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span>        </span><a name="local-6989586621680602593"><a href="#local-6989586621680602593"><span class="hs-identifier">tnBalance</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">min</span><span> </span><a href="#local-6989586621680602579"><span class="hs-identifier hs-var">maxTnBalance</span></a><span> </span><a href="#local-6989586621680602582"><span class="hs-identifier hs-var">tboTotalBalance</span></a><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621680602594"><a href="#local-6989586621680602594"><span class="hs-identifier">richBs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680602595"><a href="#local-6989586621680602595"><span class="hs-identifier">poorBs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-101"></a><span>            </span><a href="Pos.Core.Genesis.Generate.html#genTestnetDistribution"><span class="hs-identifier hs-var">genTestnetDistribution</span></a><span> </span><a href="#local-6989586621680602575"><span class="hs-identifier hs-var">tiTestBalance</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621680602593"><span class="hs-identifier hs-var">tnBalance</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621680602587"><span class="hs-identifier hs-var">fakeAvvmBalance</span></a><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span>        </span><span class="hs-comment">-- ^ Rich and poor balances</span><span>
</span><a name="line-103"></a><span>        </span><a name="local-6989586621680602596"><a href="#local-6989586621680602596"><span class="hs-identifier">richAs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Pos.Core.Address.html#makePubKeyAddressBoot"><span class="hs-identifier hs-var">makePubKeyAddressBoot</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Pos.Crypto.Signing.Types.Signing.html#toPublic"><span class="hs-identifier hs-var">toPublic</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fst</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680602590"><span class="hs-identifier hs-var">richSkVssCerts</span></a><span>
</span><a name="line-104"></a><span>        </span><span class="hs-comment">-- ^ Rich addresses</span><span>
</span><a name="line-105"></a><span>        </span><a name="local-6989586621680602597"><a href="#local-6989586621680602597"><span class="hs-identifier">poorAs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><span class="hs-identifier hs-var">_5</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680602589"><span class="hs-identifier hs-var">poorsList</span></a><span>
</span><a name="line-106"></a><span>        </span><span class="hs-comment">-- ^ Poor addresses</span><span>
</span><a name="line-107"></a><span>        </span><a name="local-6989586621680602598"><a href="#local-6989586621680602598"><span class="hs-identifier">nonAvvmDistr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HM</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621680602592"><span class="hs-identifier hs-var">safeZip</span></a><span> </span><span class="hs-string">&quot;rich&quot;</span><span> </span><a href="#local-6989586621680602596"><span class="hs-identifier hs-var">richAs</span></a><span> </span><a href="#local-6989586621680602594"><span class="hs-identifier hs-var">richBs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621680602592"><span class="hs-identifier hs-var">safeZip</span></a><span> </span><span class="hs-string">&quot;poor&quot;</span><span> </span><a href="#local-6989586621680602597"><span class="hs-identifier hs-var">poorAs</span></a><span> </span><a href="#local-6989586621680602595"><span class="hs-identifier hs-var">poorBs</span></a><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680602607"><a href="#local-6989586621680602607"><span class="hs-identifier">toStakeholders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Pos.Core.Address.html#addressHash"><span class="hs-identifier hs-var">addressHash</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Pos.Crypto.Signing.Types.Signing.html#toPublic"><span class="hs-identifier hs-var">toPublic</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fst</span><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680602608"><a href="#local-6989586621680602608"><span class="hs-identifier">toVss</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HM</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">_1</span><span> </span><span class="hs-operator hs-var">%~</span><span> </span><a href="Pos.Core.Address.html#addressHash"><span class="hs-identifier hs-var">addressHash</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Pos.Crypto.Signing.Types.Signing.html#toPublic"><span class="hs-identifier hs-var">toPublic</span></a><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680602609"><a href="#local-6989586621680602609"><span class="hs-identifier">bootStakeholders</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680602610"><a href="#local-6989586621680602610"><span class="hs-identifier">vssCerts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-113"></a><span>            </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680602577"><span class="hs-identifier hs-var">tiDistribution</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-114"></a><span>                </span><a href="Pos.Core.Genesis.Types.html#TestnetRichmenStakeDistr"><span class="hs-identifier hs-var">TestnetRichmenStakeDistr</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-115"></a><span>                    </span><span class="hs-special">(</span><a href="#local-6989586621680602607"><span class="hs-identifier hs-var">toStakeholders</span></a><span> </span><a href="#local-6989586621680602590"><span class="hs-identifier hs-var">richSkVssCerts</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Core.Genesis.Types.html#GenesisVssCertificatesMap"><span class="hs-identifier hs-var">GenesisVssCertificatesMap</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621680602608"><span class="hs-identifier hs-var">toVss</span></a><span> </span><a href="#local-6989586621680602590"><span class="hs-identifier hs-var">richSkVssCerts</span></a><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span>                </span><a href="Pos.Core.Genesis.Types.html#TestnetCustomStakeDistr"><span class="hs-identifier hs-var">TestnetCustomStakeDistr</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-117"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier">getGenesisWStakeholders</span><span> </span><a href="#local-6989586621680602611"><span class="hs-identifier hs-var">tcsdBootStakeholders</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680602612"><span class="hs-identifier hs-var">tcsdVssCerts</span></a><span class="hs-special">)</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span>    </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pos.Core.Genesis.Generate.html#GeneratedGenesisData"><span class="hs-identifier hs-var">GeneratedGenesisData</span></a><span>
</span><a name="line-120"></a><span>        </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ggdNonAvvm</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Core.Genesis.Types.html#GenesisNonAvvmBalances"><span class="hs-identifier hs-var">GenesisNonAvvmBalances</span></a><span> </span><a href="#local-6989586621680602598"><span class="hs-identifier hs-var">nonAvvmDistr</span></a><span>
</span><a name="line-121"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ggdAvvm</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680602585"><span class="hs-identifier hs-var">fakeAvvmDistr</span></a><span>
</span><a name="line-122"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ggdBootStakeholders</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Core.Genesis.Types.html#GenesisWStakeholders"><span class="hs-identifier hs-var">GenesisWStakeholders</span></a><span> </span><a href="#local-6989586621680602609"><span class="hs-identifier hs-var">bootStakeholders</span></a><span>
</span><a name="line-123"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ggdVssCerts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680602610"><span class="hs-identifier hs-var">vssCerts</span></a><span>
</span><a name="line-124"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ggdSecrets</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pos.Core.Genesis.Generate.html#GeneratedSecrets"><span class="hs-identifier hs-var">GeneratedSecrets</span></a><span>
</span><a name="line-125"></a><span>              </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">gsSecretKeys</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680602591"><span class="hs-identifier hs-var">secretKeys</span></a><span>
</span><a name="line-126"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">gsFakeAvvmSeeds</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680602586"><span class="hs-identifier hs-var">seeds</span></a><span>
</span><a name="line-127"></a><span>              </span><span class="hs-special">}</span><span>
</span><a name="line-128"></a><span>        </span><span class="hs-special">}</span><span>
</span><a name="line-129"></a><span class="hs-identifier">generateGenesisData</span><span> </span><a href="Pos.Core.Genesis.Types.html#MainnetInitializer"><span class="hs-identifier hs-var">MainnetInitializer</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-130"></a><span>    </span><a href="Pos.Core.Genesis.Generate.html#GeneratedGenesisData"><span class="hs-identifier hs-var">GeneratedGenesisData</span></a><span> </span><a href="#local-6989586621680602616"><span class="hs-identifier hs-var">miNonAvvmBalances</span></a><span> </span><span class="hs-identifier hs-var">mempty</span><span> </span><a href="#local-6989586621680602614"><span class="hs-identifier hs-var">miBootStakeholders</span></a><span> </span><a href="#local-6989586621680602615"><span class="hs-identifier hs-var">miVssCerts</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-identifier">generateFakeAvvmGenesis</span><span>
</span><a name="line-133"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadRandom</span><span> </span><a href="#local-6989586621680602574"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Pos.Core.Genesis.Types.html#FakeAvvmOptions"><span class="hs-identifier hs-type">FakeAvvmOptions</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680602574"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Pos.Core.Genesis.Types.html#GenesisAvvmBalances"><span class="hs-identifier hs-type">GenesisAvvmBalances</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Word64</span><span class="hs-special">)</span><span>
</span><a name="line-135"></a><a name="generateFakeAvvmGenesis"><a href="Pos.Core.Genesis.Generate.html#generateFakeAvvmGenesis"><span class="hs-identifier">generateFakeAvvmGenesis</span></a></a><span> </span><a href="Pos.Core.Genesis.Types.html#FakeAvvmOptions"><span class="hs-identifier hs-var">FakeAvvmOptions</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-136"></a><span>    </span><a name="local-6989586621680602619"><a href="#local-6989586621680602619"><span class="hs-identifier">fakeAvvmPubkeysAndSeeds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">replicateM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621680602617"><span class="hs-identifier hs-var">faoCount</span></a><span class="hs-special">)</span><span> </span><a href="Pos.Core.Genesis.Generate.html#generateFakeAvvm"><span class="hs-identifier hs-var">generateFakeAvvm</span></a><span>
</span><a name="line-137"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680602620"><a href="#local-6989586621680602620"><span class="hs-identifier">oneBalance</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Core.Types.html#mkCoin"><span class="hs-identifier hs-var">mkCoin</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621680602618"><span class="hs-identifier hs-var">faoOneBalance</span></a><span>
</span><a name="line-138"></a><span>        </span><a name="local-6989586621680602621"><a href="#local-6989586621680602621"><span class="hs-identifier">fakeAvvms</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><a href="#local-6989586621680602620"><span class="hs-identifier hs-var">oneBalance</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fst</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680602619"><span class="hs-identifier hs-var">fakeAvvmPubkeysAndSeeds</span></a><span>
</span><a name="line-139"></a><span>    </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span> </span><a href="Pos.Core.Genesis.Types.html#GenesisAvvmBalances"><span class="hs-identifier hs-var">GenesisAvvmBalances</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HM</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><a href="#local-6989586621680602621"><span class="hs-identifier hs-var">fakeAvvms</span></a><span>
</span><a name="line-140"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621680602619"><span class="hs-identifier hs-var">fakeAvvmPubkeysAndSeeds</span></a><span>
</span><a name="line-141"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621680602618"><span class="hs-identifier hs-var">faoOneBalance</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621680602617"><span class="hs-identifier hs-var">faoCount</span></a><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-144"></a><span class="hs-comment">-- Helpers</span><span>
</span><a name="line-145"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-146"></a><span>
</span><a name="line-147"></a><span class="hs-identifier">generateSecretsAndAddress</span><span>
</span><a name="line-148"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Pos.Core.Configuration.Protocol.html#HasProtocolConstants"><span class="hs-identifier hs-type">HasProtocolConstants</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadRandom</span><span> </span><a href="#local-6989586621680602573"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Pos.Crypto.Signing.Types.Signing.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.Signing.Types.Safe.html#EncryptedSecretKey"><span class="hs-identifier hs-type">EncryptedSecretKey</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ plain key &amp; hd wallet root key</span><span>
</span><a name="line-150"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>                                   </span><span class="hs-comment">-- ^ whether address contains hd payload</span><span>
</span><a name="line-151"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680602573"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Pos.Crypto.Signing.Types.Signing.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.Signing.Types.Safe.html#EncryptedSecretKey"><span class="hs-identifier hs-type">EncryptedSecretKey</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.SecretSharing.html#VssKeyPair"><span class="hs-identifier hs-type">VssKeyPair</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Core.Vss.Types.html#VssCertificate"><span class="hs-identifier hs-type">VssCertificate</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Core.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>    </span><span class="hs-comment">-- ^ secret key, vss key pair, vss certificate,</span><span>
</span><a name="line-153"></a><span>    </span><span class="hs-comment">-- hd wallet account address with bootstrap era distribution</span><span>
</span><a name="line-154"></a><a name="generateSecretsAndAddress"><a href="Pos.Core.Genesis.Generate.html#generateSecretsAndAddress"><span class="hs-identifier">generateSecretsAndAddress</span></a></a><span> </span><a name="local-6989586621680602622"><a href="#local-6989586621680602622"><span class="hs-identifier">mbSk</span></a></a><span> </span><a name="local-6989586621680602623"><a href="#local-6989586621680602623"><span class="hs-identifier">hasHDPayload</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-155"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621680602624"><a href="#local-6989586621680602624"><span class="hs-identifier">sk</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680602625"><a href="#local-6989586621680602625"><span class="hs-identifier">hdwSk</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680602626"><a href="#local-6989586621680602626"><span class="hs-identifier">vss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Pos.Core.Genesis.Generate.html#generateSecrets"><span class="hs-identifier hs-var">generateSecrets</span></a><span> </span><a href="#local-6989586621680602622"><span class="hs-identifier hs-var">mbSk</span></a><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span>    </span><a name="local-6989586621680602627"><a href="#local-6989586621680602627"><span class="hs-identifier">expiry</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">fromInteger</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span>
</span><a name="line-158"></a><span>        </span><a href="Pos.Crypto.Random.html#randomNumberInRange"><span class="hs-identifier hs-var">randomNumberInRange</span></a><span> </span><span class="hs-special">(</span><a href="Pos.Core.Configuration.Protocol.html#vssMinTTL"><span class="hs-identifier hs-var">vssMinTTL</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Pos.Core.Configuration.Protocol.html#vssMaxTTL"><span class="hs-identifier hs-var">vssMaxTTL</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-159"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680602628"><a href="#local-6989586621680602628"><span class="hs-identifier">vssPk</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Binary.Class.Primitive.html#asBinary"><span class="hs-identifier hs-var">asBinary</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pos.Crypto.SecretSharing.html#toVssPublicKey"><span class="hs-identifier hs-var">toVssPublicKey</span></a><span> </span><a href="#local-6989586621680602626"><span class="hs-identifier hs-var">vss</span></a><span>
</span><a name="line-160"></a><span>        </span><a name="local-6989586621680602629"><a href="#local-6989586621680602629"><span class="hs-identifier">vssCert</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Core.Vss.html#mkVssCertificate"><span class="hs-identifier hs-var">mkVssCertificate</span></a><span> </span><a href="#local-6989586621680602624"><span class="hs-identifier hs-var">sk</span></a><span> </span><a href="#local-6989586621680602628"><span class="hs-identifier hs-var">vssPk</span></a><span> </span><a href="#local-6989586621680602627"><span class="hs-identifier hs-var">expiry</span></a><span>
</span><a name="line-161"></a><span>        </span><span class="hs-comment">-- This address is used only to create genesis data. We don't</span><span>
</span><a name="line-162"></a><span>        </span><span class="hs-comment">-- put it into a keyfile.</span><span>
</span><a name="line-163"></a><span>        </span><a name="local-6989586621680602630"><a href="#local-6989586621680602630"><span class="hs-identifier">hdwAccountPk</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-164"></a><span>            </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621680602623"><span class="hs-identifier hs-var">hasHDPayload</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Pos.Core.Address.html#makePubKeyAddressBoot"><span class="hs-identifier hs-var">makePubKeyAddressBoot</span></a><span> </span><span class="hs-special">(</span><a href="Pos.Crypto.Signing.Types.Signing.html#toPublic"><span class="hs-identifier hs-var">toPublic</span></a><span> </span><a href="#local-6989586621680602624"><span class="hs-identifier hs-var">sk</span></a><span class="hs-special">)</span><span>
</span><a name="line-165"></a><span>            </span><span class="hs-keyword">else</span><span>
</span><a name="line-166"></a><span>                </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;generateKeyfile: pass mismatch&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-167"></a><span>                </span><a href="Pos.Core.Address.html#deriveLvl2KeyPair"><span class="hs-identifier hs-var">deriveLvl2KeyPair</span></a><span> </span><span class="hs-special">(</span><a href="Pos.Core.Address.html#IsBootstrapEraAddr"><span class="hs-identifier hs-var">IsBootstrapEraAddr</span></a><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Pos.Crypto.HD.html#ShouldCheckPassphrase"><span class="hs-identifier hs-var">ShouldCheckPassphrase</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><a href="Pos.Crypto.Signing.Types.Safe.html#emptyPassphrase"><span class="hs-identifier hs-var">emptyPassphrase</span></a><span> </span><a href="#local-6989586621680602625"><span class="hs-identifier hs-var">hdwSk</span></a><span>
</span><a name="line-168"></a><span>                    </span><a href="Pos.Core.Genesis.Constants.html#accountGenesisIndex"><span class="hs-identifier hs-var">Const</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">accountGenesisIndex</span></a><span> </span><a href="Pos.Core.Genesis.Constants.html#wAddressGenesisIndex"><span class="hs-identifier hs-var">Const</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">wAddressGenesisIndex</span></a><span>
</span><a name="line-169"></a><span>    </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680602624"><span class="hs-identifier hs-var">sk</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680602625"><span class="hs-identifier hs-var">hdwSk</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680602626"><span class="hs-identifier hs-var">vss</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680602629"><span class="hs-identifier hs-var">vssCert</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680602630"><span class="hs-identifier hs-var">hdwAccountPk</span></a><span class="hs-special">)</span><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span class="hs-identifier">generateFakeAvvm</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadRandom</span><span> </span><a href="#local-6989586621680602572"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621680602572"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Pos.Crypto.Signing.Types.Redeem.html#RedeemPublicKey"><span class="hs-identifier hs-type">RedeemPublicKey</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">)</span><span>
</span><a name="line-172"></a><a name="generateFakeAvvm"><a href="Pos.Core.Genesis.Generate.html#generateFakeAvvm"><span class="hs-identifier">generateFakeAvvm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-173"></a><span>    </span><a name="local-6989586621680602631"><a href="#local-6989586621680602631"><span class="hs-identifier">seed</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getRandomBytes</span><span> </span><span class="hs-number">32</span><span>
</span><a name="line-174"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680602632"><a href="#local-6989586621680602632"><span class="hs-identifier">pk</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span>
</span><a name="line-175"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Impossible - seed is not 32 bytes long&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-176"></a><span>            </span><a href="Pos.Crypto.Signing.Redeem.html#redeemDeterministicKeyGen"><span class="hs-identifier hs-var">redeemDeterministicKeyGen</span></a><span> </span><a href="#local-6989586621680602631"><span class="hs-identifier hs-var">seed</span></a><span>
</span><a name="line-177"></a><span>    </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680602632"><span class="hs-identifier hs-var">pk</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680602631"><span class="hs-identifier hs-var">seed</span></a><span class="hs-special">)</span><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span class="hs-identifier">generateSecrets</span><span>
</span><a name="line-180"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadRandom</span><span> </span><a href="#local-6989586621680602571"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-181"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Pos.Crypto.Signing.Types.Signing.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.Signing.Types.Safe.html#EncryptedSecretKey"><span class="hs-identifier hs-type">EncryptedSecretKey</span></a><span class="hs-special">)</span><span>
</span><a name="line-182"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680602571"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Pos.Crypto.Signing.Types.Signing.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.Signing.Types.Safe.html#EncryptedSecretKey"><span class="hs-identifier hs-type">EncryptedSecretKey</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Crypto.SecretSharing.html#VssKeyPair"><span class="hs-identifier hs-type">VssKeyPair</span></a><span class="hs-special">)</span><span>
</span><a name="line-183"></a><a name="generateSecrets"><a href="Pos.Core.Genesis.Generate.html#generateSecrets"><span class="hs-identifier">generateSecrets</span></a></a><span> </span><a name="local-6989586621680602633"><a href="#local-6989586621680602633"><span class="hs-identifier">mbSk</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-184"></a><span>    </span><span class="hs-comment">-- plain key &amp; hd wallet root key</span><span>
</span><a name="line-185"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621680602635"><a href="#local-6989586621680602635"><span class="hs-identifier">sk</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680602636"><a href="#local-6989586621680602636"><span class="hs-identifier">hdwSk</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a name="line-186"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680602633"><span class="hs-identifier hs-var">mbSk</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-187"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621680602634"><a href="#local-6989586621680602634"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621680602634"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-188"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-189"></a><span>                </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Pos.Crypto.Signing.Signing.html#keyGen"><span class="hs-identifier hs-var">keyGen</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span>
</span><a name="line-190"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Pos.Crypto.Signing.Safe.html#safeKeyGen"><span class="hs-identifier hs-var">safeKeyGen</span></a><span> </span><a href="Pos.Crypto.Signing.Types.Safe.html#emptyPassphrase"><span class="hs-identifier hs-var">emptyPassphrase</span></a><span class="hs-special">)</span><span>
</span><a name="line-191"></a><span>    </span><a name="local-6989586621680602637"><a href="#local-6989586621680602637"><span class="hs-identifier">vss</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Pos.Crypto.SecretSharing.html#vssKeyGen"><span class="hs-identifier hs-var">vssKeyGen</span></a><span>
</span><a name="line-192"></a><span>    </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680602635"><span class="hs-identifier hs-var">sk</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680602636"><span class="hs-identifier hs-var">hdwSk</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680602637"><span class="hs-identifier hs-var">vss</span></a><span class="hs-special">)</span><span>
</span><a name="line-193"></a><span>
</span><a name="line-194"></a><span class="hs-comment">-- | Generates balance distribution for testnet.</span><span>
</span><a name="line-195"></a><span class="hs-identifier">genTestnetDistribution</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-196"></a><span>       </span><a href="Pos.Core.Configuration.BlockVersionData.html#HasGenesisBlockVersionData"><span class="hs-identifier hs-type">HasGenesisBlockVersionData</span></a><span>
</span><a name="line-197"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Pos.Core.Genesis.Types.html#TestnetBalanceOptions"><span class="hs-identifier hs-type">TestnetBalanceOptions</span></a><span>
</span><a name="line-198"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-199"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Pos.Core.Types.html#Coin"><span class="hs-identifier hs-type">Coin</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Pos.Core.Types.html#Coin"><span class="hs-identifier hs-type">Coin</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-200"></a><a name="genTestnetDistribution"><a href="Pos.Core.Genesis.Generate.html#genTestnetDistribution"><span class="hs-identifier">genTestnetDistribution</span></a></a><span> </span><a href="Pos.Core.Genesis.Types.html#TestnetBalanceOptions"><span class="hs-identifier hs-var">TestnetBalanceOptions</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><a name="local-6989586621680602643"><a href="#local-6989586621680602643"><span class="hs-identifier">testBalance</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-201"></a><span>    </span><a href="#local-6989586621680602656"><span class="hs-identifier hs-var">checkConsistency</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680602653"><span class="hs-identifier hs-var">richBalances</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680602654"><span class="hs-identifier hs-var">poorBalances</span></a><span class="hs-special">)</span><span>
</span><a name="line-202"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-203"></a><span>    </span><a name="local-6989586621680602644"><a href="#local-6989586621680602644"><span class="hs-identifier">richs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621680602639"><span class="hs-identifier hs-var">tboRichmen</span></a><span>
</span><a name="line-204"></a><span>    </span><a name="local-6989586621680602645"><a href="#local-6989586621680602645"><span class="hs-identifier">poors</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621680602638"><span class="hs-identifier hs-var">tboPoors</span></a><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span>    </span><span class="hs-comment">-- Calculate actual balances</span><span>
</span><a name="line-207"></a><span>    </span><a name="local-6989586621680602646"><a href="#local-6989586621680602646"><span class="hs-identifier">desiredRichBalance</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680602657"><span class="hs-identifier hs-var">getShare</span></a><span> </span><a href="#local-6989586621680602641"><span class="hs-identifier hs-var">tboRichmenShare</span></a><span> </span><a href="#local-6989586621680602643"><span class="hs-identifier hs-var">testBalance</span></a><span>
</span><a name="line-208"></a><span>    </span><a name="local-6989586621680602647"><a href="#local-6989586621680602647"><span class="hs-identifier">oneRichmanBalance</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680602646"><span class="hs-identifier hs-var">desiredRichBalance</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621680602644"><span class="hs-identifier hs-var">richs</span></a><span> </span><span class="hs-operator hs-var">+</span><span>
</span><a name="line-209"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621680602646"><span class="hs-identifier hs-var">desiredRichBalance</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mod</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621680602644"><span class="hs-identifier hs-var">richs</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-210"></a><span>    </span><a name="local-6989586621680602648"><a href="#local-6989586621680602648"><span class="hs-identifier">realRichBalance</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680602647"><span class="hs-identifier hs-var">oneRichmanBalance</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621680602644"><span class="hs-identifier hs-var">richs</span></a><span>
</span><a name="line-211"></a><span>    </span><a name="local-6989586621680602649"><a href="#local-6989586621680602649"><span class="hs-identifier">poorsBalance</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680602643"><span class="hs-identifier hs-var">testBalance</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621680602648"><span class="hs-identifier hs-var">realRichBalance</span></a><span>
</span><a name="line-212"></a><span>    </span><a name="local-6989586621680602650"><a href="#local-6989586621680602650"><span class="hs-identifier">onePoorBalance</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621680602645"><span class="hs-identifier hs-var">poors</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621680602649"><span class="hs-identifier hs-var">poorsBalance</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621680602645"><span class="hs-identifier hs-var">poors</span></a><span>
</span><a name="line-213"></a><span>    </span><a name="local-6989586621680602651"><a href="#local-6989586621680602651"><span class="hs-identifier">realPoorBalance</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680602650"><span class="hs-identifier hs-var">onePoorBalance</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621680602645"><span class="hs-identifier hs-var">poors</span></a><span>
</span><a name="line-214"></a><span>
</span><a name="line-215"></a><span>    </span><a name="local-6989586621680602652"><a href="#local-6989586621680602652"><span class="hs-identifier">mpcBalance</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680602657"><span class="hs-identifier hs-var">getShare</span></a><span> </span><span class="hs-special">(</span><a href="Pos.Core.Coin.html#coinPortionToDouble"><span class="hs-identifier hs-var">coinPortionToDouble</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">bvdMpcThd</span><span> </span><a href="Pos.Core.Configuration.BlockVersionData.html#genesisBlockVersionData"><span class="hs-identifier hs-var">genesisBlockVersionData</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680602643"><span class="hs-identifier hs-var">testBalance</span></a><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span>    </span><a name="local-6989586621680602653"><a href="#local-6989586621680602653"><span class="hs-identifier">richBalances</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">replicate</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680602644"><span class="hs-identifier hs-var">richs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Pos.Core.Coin.html#unsafeIntegerToCoin"><span class="hs-identifier hs-var">unsafeIntegerToCoin</span></a><span> </span><a href="#local-6989586621680602647"><span class="hs-identifier hs-var">oneRichmanBalance</span></a><span class="hs-special">)</span><span>
</span><a name="line-218"></a><span>    </span><a name="local-6989586621680602654"><a href="#local-6989586621680602654"><span class="hs-identifier">poorBalances</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">replicate</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680602645"><span class="hs-identifier hs-var">poors</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Pos.Core.Coin.html#unsafeIntegerToCoin"><span class="hs-identifier hs-var">unsafeIntegerToCoin</span></a><span> </span><a href="#local-6989586621680602650"><span class="hs-identifier hs-var">onePoorBalance</span></a><span class="hs-special">)</span><span>
</span><a name="line-219"></a><span>
</span><a name="line-220"></a><span>    </span><span class="hs-comment">-- Consistency checks</span><span>
</span><a name="line-221"></a><span>    </span><span class="hs-identifier">everythingIsConsistent</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-222"></a><span>    </span><a name="local-6989586621680602655"><a href="#local-6989586621680602655"><span class="hs-identifier">everythingIsConsistent</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-223"></a><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span> </span><a href="#local-6989586621680602648"><span class="hs-identifier hs-var">realRichBalance</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621680602651"><span class="hs-identifier hs-var">realPoorBalance</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621680602643"><span class="hs-identifier hs-var">testBalance</span></a><span>
</span><a name="line-224"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;Real rich + poor balance is more than desired.&quot;</span><span>
</span><a name="line-225"></a><span>          </span><span class="hs-special">)</span><span>
</span><a name="line-226"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span> </span><a href="#local-6989586621680602647"><span class="hs-identifier hs-var">oneRichmanBalance</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621680602652"><span class="hs-identifier hs-var">mpcBalance</span></a><span>
</span><a name="line-227"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;Richman's balance is less than MPC threshold&quot;</span><span>
</span><a name="line-228"></a><span>          </span><span class="hs-special">)</span><span>
</span><a name="line-229"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span> </span><a href="#local-6989586621680602650"><span class="hs-identifier hs-var">onePoorBalance</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621680602652"><span class="hs-identifier hs-var">mpcBalance</span></a><span>
</span><a name="line-230"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;Poor's balance is more than MPC threshold&quot;</span><span>
</span><a name="line-231"></a><span>          </span><span class="hs-special">)</span><span>
</span><a name="line-232"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span>    </span><span class="hs-identifier">checkConsistency</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621680602658"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680602658"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-235"></a><span>    </span><a name="local-6989586621680602656"><a href="#local-6989586621680602656"><span class="hs-identifier">checkConsistency</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">verifyGeneric</span><span> </span><a href="#local-6989586621680602655"><span class="hs-identifier hs-var">everythingIsConsistent</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-236"></a><span>        </span><span class="hs-identifier hs-var">VerSuccess</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">identity</span><span>
</span><a name="line-237"></a><span>        </span><span class="hs-identifier hs-var">VerFailure</span><span> </span><a name="local-6989586621680602659"><a href="#local-6989586621680602659"><span class="hs-identifier">errors</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">formatAllErrors</span><span> </span><a href="#local-6989586621680602659"><span class="hs-identifier hs-var">errors</span></a><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span>    </span><span class="hs-identifier">getShare</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-240"></a><span>    </span><a name="local-6989586621680602657"><a href="#local-6989586621680602657"><span class="hs-identifier">getShare</span></a></a><span> </span><a name="local-6989586621680602660"><a href="#local-6989586621680602660"><span class="hs-identifier">sh</span></a></a><span> </span><a name="local-6989586621680602661"><a href="#local-6989586621680602661"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">round</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621680602660"><span class="hs-identifier hs-var">sh</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680602661"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-241"></a></pre></body></html>