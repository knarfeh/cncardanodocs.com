<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | Common things used in `Pos.Crypto.Arbitrary` and `Pos.Util.Arbitrary`</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Util</span><span class="hs-operator">.</span><span class="hs-identifier">Arbitrary</span><span>
</span><a name="line-4"></a><span>       </span><span class="hs-special">(</span><span> </span><a href="Pos.Util.Arbitrary.html#Nonrepeating"><span class="hs-identifier hs-type">Nonrepeating</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-5"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Util.Arbitrary.html#ArbitraryUnsafe"><span class="hs-identifier hs-type">ArbitraryUnsafe</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-6"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Util.Arbitrary.html#SmallGenerator"><span class="hs-identifier hs-type">SmallGenerator</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-7"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Util.Arbitrary.html#makeSmall"><span class="hs-identifier hs-var">makeSmall</span></a><span>
</span><a name="line-8"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Util.Arbitrary.html#sublistN"><span class="hs-identifier hs-var">sublistN</span></a><span>
</span><a name="line-9"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Util.Arbitrary.html#unsafeMakeList"><span class="hs-identifier hs-var">unsafeMakeList</span></a><span>
</span><a name="line-10"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Util.Arbitrary.html#unsafeMakePool"><span class="hs-identifier hs-var">unsafeMakePool</span></a><span>
</span><a name="line-11"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Util.Arbitrary.html#arbitrarySizedS"><span class="hs-identifier hs-var">arbitrarySizedS</span></a><span>
</span><a name="line-12"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Util.Arbitrary.html#arbitrarySizedSL"><span class="hs-identifier hs-var">arbitrarySizedSL</span></a><span>
</span><a name="line-13"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Util.Arbitrary.html#runGen"><span class="hs-identifier hs-var">runGen</span></a><span>
</span><a name="line-14"></a><span>       </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Binary.Class.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Binary</span><span class="hs-operator">.</span><span class="hs-identifier">Class</span></a><span>       </span><span class="hs-special">(</span><a href="Pos.Binary.Class.Core.html#Bi"><span class="hs-identifier hs-type">Bi</span></a><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pack</span><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span class="hs-operator">.</span><span class="hs-identifier">Lazy</span><span>   </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BL</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">pack</span><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span class="hs-operator">.</span><span class="hs-identifier">NonEmpty</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NonEmpty</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">:|</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span class="hs-operator">.</span><span class="hs-identifier">Unsafe</span><span>       </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unsafePerformIO</span><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Test</span><span class="hs-operator">.</span><span class="hs-identifier">QuickCheck</span><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Gen</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">listOf</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">scale</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">shuffle</span><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>                                         </span><span class="hs-identifier hs-var">vector</span><span class="hs-special">)</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Test</span><span class="hs-operator">.</span><span class="hs-identifier">QuickCheck</span><span class="hs-operator">.</span><span class="hs-identifier">Gen</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unGen</span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Test</span><span class="hs-operator">.</span><span class="hs-identifier">QuickCheck</span><span class="hs-operator">.</span><span class="hs-identifier">Random</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkQCGen</span><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Universum</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span class="hs-identifier">makeSmall</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Gen</span><span> </span><a href="#local-6989586621680694780"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Gen</span><span> </span><a href="#local-6989586621680694780"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-28"></a><a name="makeSmall"><a href="Pos.Util.Arbitrary.html#makeSmall"><span class="hs-identifier">makeSmall</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">scale</span><span> </span><a href="#local-6989586621680694781"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-29"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-30"></a><span>    </span><span class="hs-comment">-- This function is &#8220;Golden function of testing&#8221;. It is perfect</span><span>
</span><a name="line-31"></a><span>    </span><span class="hs-comment">-- for making tested values small. There was a profound research</span><span>
</span><a name="line-32"></a><span>    </span><span class="hs-comment">-- in this area. `f 4` is 3, yes.</span><span>
</span><a name="line-33"></a><span>    </span><a name="local-6989586621680694781"><a href="#local-6989586621680694781"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-34"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-35"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-36"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span>
</span><a name="line-37"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span>
</span><a name="line-38"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621680694782"><a href="#local-6989586621680694782"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-39"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680694782"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680694782"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-40"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-41"></a><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">round</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">realToFrac</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><span class="hs-number">3</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680694782"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-keyword">newtype</span><span> </span><a name="SmallGenerator"><a href="Pos.Util.Arbitrary.html#SmallGenerator"><span class="hs-identifier">SmallGenerator</span></a></a><span> </span><a name="local-6989586621680694775"><a href="#local-6989586621680694775"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SmallGenerator"><a href="Pos.Util.Arbitrary.html#SmallGenerator"><span class="hs-identifier">SmallGenerator</span></a></a><span>
</span><a name="line-44"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="getSmallGenerator"><a href="Pos.Util.Arbitrary.html#getSmallGenerator"><span class="hs-identifier">getSmallGenerator</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621680694775"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-45"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="#local-6989586621680694864"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><a href="Pos.Util.Arbitrary.html#SmallGenerator"><span class="hs-identifier hs-type">SmallGenerator</span></a><span> </span><a href="#local-6989586621680694864"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-48"></a><span>    </span><a name="local-8214565720323816918"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Util.Arbitrary.html#SmallGenerator"><span class="hs-identifier hs-var">SmallGenerator</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Pos.Util.Arbitrary.html#makeSmall"><span class="hs-identifier hs-var">makeSmall</span></a><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-49"></a><span>    </span><a name="local-8214565720323816917"><span class="hs-identifier">shrink</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Pos.Util.Arbitrary.html#SmallGenerator"><span class="hs-identifier hs-var">SmallGenerator</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">shrink</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">getSmallGenerator</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><a href="Pos.Binary.Class.Core.html#Bi"><span class="hs-identifier hs-type">Bi</span></a><span> </span><a href="#local-6989586621680694865"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Pos.Binary.Class.Core.html#Bi"><span class="hs-identifier hs-type">Bi</span></a><span> </span><span class="hs-special">(</span><a href="Pos.Util.Arbitrary.html#SmallGenerator"><span class="hs-identifier hs-type">SmallGenerator</span></a><span> </span><a href="#local-6989586621680694865"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-comment">-- | Choose a random (shuffled) subset of length n. Throws an error if</span><span>
</span><a name="line-54"></a><span class="hs-comment">-- there's not enough elements.</span><span>
</span><a name="line-55"></a><span class="hs-identifier">sublistN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680694779"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Gen</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680694779"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-56"></a><a name="sublistN"><a href="Pos.Util.Arbitrary.html#sublistN"><span class="hs-identifier">sublistN</span></a></a><span> </span><a name="local-6989586621680694783"><a href="#local-6989586621680694783"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680694784"><a href="#local-6989586621680694784"><span class="hs-identifier">xs</span></a></a><span>
</span><a name="line-57"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621680694784"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621680694783"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;sublistN: not enough elements&quot;</span><span>
</span><a name="line-58"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">take</span><span> </span><a href="#local-6989586621680694783"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">shuffle</span><span> </span><a href="#local-6989586621680694784"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-comment">-- | Type for generating list of unique (nonrepeating) elemets.</span><span>
</span><a name="line-61"></a><span class="hs-keyword">class</span><span> </span><a name="Nonrepeating"><a href="Pos.Util.Arbitrary.html#Nonrepeating"><span class="hs-identifier">Nonrepeating</span></a></a><span> </span><a name="local-6989586621680694774"><a href="#local-6989586621680694774"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-62"></a><span>    </span><span class="hs-identifier">nonrepeating</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Gen</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680694774"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-comment">-- | Unsafely create pool of `n` random values to be picked</span><span>
</span><a name="line-65"></a><span class="hs-comment">-- (see note in `Pos.Crypto.Arbitrary` for explanation)</span><span>
</span><a name="line-66"></a><span class="hs-identifier">unsafeMakePool</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621680694778"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680694778"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-67"></a><a name="unsafeMakePool"><a href="Pos.Util.Arbitrary.html#unsafeMakePool"><span class="hs-identifier">unsafeMakePool</span></a></a><span> </span><a name="local-6989586621680694785"><a href="#local-6989586621680694785"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621680694786"><a href="#local-6989586621680694786"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680694787"><a href="#local-6989586621680694787"><span class="hs-identifier">action</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-68"></a><span>    </span><span class="hs-identifier hs-var">putText</span><span> </span><a href="#local-6989586621680694785"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-69"></a><span>    </span><span class="hs-identifier hs-var">replicateM</span><span> </span><a href="#local-6989586621680694786"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680694787"><span class="hs-identifier hs-var">action</span></a><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-comment">-- | Unsafely create list of `n` random values to be picked</span><span>
</span><a name="line-72"></a><span class="hs-comment">-- (see note in `Pos.Crypto.Arbitrary` for explanation)</span><span>
</span><a name="line-73"></a><span class="hs-comment">-- Used because genSharedSecret already returns a list</span><span>
</span><a name="line-74"></a><span class="hs-comment">-- of EncShares, making the 'replicateM' unneeded.</span><span>
</span><a name="line-75"></a><span class="hs-identifier">unsafeMakeList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680694777"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680694777"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-76"></a><a name="unsafeMakeList"><a href="Pos.Util.Arbitrary.html#unsafeMakeList"><span class="hs-identifier">unsafeMakeList</span></a></a><span> </span><a name="local-6989586621680694855"><a href="#local-6989586621680694855"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621680694856"><a href="#local-6989586621680694856"><span class="hs-identifier">action</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-77"></a><span>    </span><span class="hs-identifier hs-var">putText</span><span> </span><a href="#local-6989586621680694855"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-78"></a><span>    </span><a href="#local-6989586621680694856"><span class="hs-identifier hs-var">action</span></a><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-comment">-- | Make arbitrary `ByteString` of given length.</span><span>
</span><a name="line-81"></a><span class="hs-identifier">arbitrarySizedS</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Gen</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-82"></a><a name="arbitrarySizedS"><a href="Pos.Util.Arbitrary.html#arbitrarySizedS"><span class="hs-identifier">arbitrarySizedS</span></a></a><span> </span><a name="local-6989586621680694857"><a href="#local-6989586621680694857"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">vector</span><span> </span><a href="#local-6989586621680694857"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span class="hs-comment">-- | Make arbitrary `ByteString.Lazy` of given length.</span><span>
</span><a name="line-85"></a><span class="hs-identifier">arbitrarySizedSL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Gen</span><span> </span><span class="hs-identifier hs-type">BL</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-86"></a><a name="arbitrarySizedSL"><a href="Pos.Util.Arbitrary.html#arbitrarySizedSL"><span class="hs-identifier">arbitrarySizedSL</span></a></a><span> </span><a name="local-6989586621680694858"><a href="#local-6989586621680694858"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">BL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">vector</span><span> </span><a href="#local-6989586621680694858"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">-- | Get something out of a quickcheck 'Gen' without having to do IO</span><span>
</span><a name="line-89"></a><span class="hs-identifier">runGen</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Gen</span><span> </span><a href="#local-6989586621680694776"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680694776"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-90"></a><a name="runGen"><a href="Pos.Util.Arbitrary.html#runGen"><span class="hs-identifier">runGen</span></a></a><span> </span><a name="local-6989586621680694859"><a href="#local-6989586621680694859"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unGen</span><span> </span><a href="#local-6989586621680694859"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkQCGen</span><span> </span><span class="hs-number">31415926</span><span class="hs-special">)</span><span> </span><span class="hs-number">30</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span class="hs-comment">{-| ArbitraryUnsafe class
    ~~~~~~~~~~~~~~~~~~~~~~~~

    This class is the same as `Arbitrary`, except instances of this class for
    stuff like public/secret keys, VSS shares, commitments etc. are designed
    not to mimic real data as presisely as possible (using OpenSSL random), but
    rather to be simple and efficient.

    This is especially useful for benchmarking.

    Note: we don't need 'Generic' to derive instances of 'ArbitraryUnsafe'.
    We can either use one-line instance declaration, or @-XStandaloneDeriving@
    or @-XDeriveAnyClass@ to write something like @deriving (Arbitrary, ArbitraryUnsafe)@.
-}</span><span>
</span><a name="line-106"></a><span class="hs-keyword">class</span><span> </span><a name="ArbitraryUnsafe"><a href="Pos.Util.Arbitrary.html#ArbitraryUnsafe"><span class="hs-identifier">ArbitraryUnsafe</span></a></a><span> </span><a name="local-6989586621680694773"><a href="#local-6989586621680694773"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-107"></a><span>    </span><span class="hs-identifier">arbitraryUnsafe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Gen</span><span> </span><a href="#local-6989586621680694773"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span>    </span><span class="hs-keyword">default</span><span> </span><span class="hs-identifier">arbitraryUnsafe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="#local-6989586621680694773"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Gen</span><span> </span><a href="#local-6989586621680694773"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-110"></a><span>    </span><a name="local-8214565720325469671"><a href="Pos.Util.Arbitrary.html#arbitraryUnsafe"><span class="hs-identifier">arbitraryUnsafe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-keyword">instance</span><span> </span><a href="Pos.Util.Arbitrary.html#ArbitraryUnsafe"><span class="hs-identifier hs-type">ArbitraryUnsafe</span></a><span> </span><span class="hs-identifier hs-type">Word16</span><span>
</span><a name="line-113"></a><span class="hs-keyword">instance</span><span> </span><a href="Pos.Util.Arbitrary.html#ArbitraryUnsafe"><span class="hs-identifier hs-type">ArbitraryUnsafe</span></a><span> </span><span class="hs-identifier hs-type">Word32</span><span>
</span><a name="line-114"></a><span class="hs-keyword">instance</span><span> </span><a href="Pos.Util.Arbitrary.html#ArbitraryUnsafe"><span class="hs-identifier hs-type">ArbitraryUnsafe</span></a><span> </span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-115"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Pos.Util.Arbitrary.html#ArbitraryUnsafe"><span class="hs-identifier hs-type">ArbitraryUnsafe</span></a><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-keyword">instance</span><span> </span><a href="Pos.Util.Arbitrary.html#ArbitraryUnsafe"><span class="hs-identifier hs-type">ArbitraryUnsafe</span></a><span> </span><a href="#local-6989586621680694863"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Pos.Util.Arbitrary.html#ArbitraryUnsafe"><span class="hs-identifier hs-type">ArbitraryUnsafe</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680694863"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-118"></a><span>    </span><a name="local-8214565720325469671"><a href="Pos.Util.Arbitrary.html#arbitraryUnsafe"><span class="hs-identifier">arbitraryUnsafe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">listOf</span><span> </span><a href="Pos.Util.Arbitrary.html#arbitraryUnsafe"><span class="hs-identifier hs-var">arbitraryUnsafe</span></a><span>
</span><a name="line-119"></a><span>
</span><a name="line-120"></a><span class="hs-keyword">instance</span><span> </span><a href="Pos.Util.Arbitrary.html#ArbitraryUnsafe"><span class="hs-identifier hs-type">ArbitraryUnsafe</span></a><span> </span><a href="#local-6989586621680694862"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Pos.Util.Arbitrary.html#ArbitraryUnsafe"><span class="hs-identifier hs-type">ArbitraryUnsafe</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NonEmpty</span><span> </span><a href="#local-6989586621680694862"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-121"></a><span>    </span><a name="local-8214565720325469671"><a href="Pos.Util.Arbitrary.html#arbitraryUnsafe"><span class="hs-identifier">arbitraryUnsafe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">:|</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Pos.Util.Arbitrary.html#arbitraryUnsafe"><span class="hs-identifier hs-var">arbitraryUnsafe</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">listOf</span><span> </span><a href="Pos.Util.Arbitrary.html#arbitraryUnsafe"><span class="hs-identifier hs-var">arbitraryUnsafe</span></a><span>
</span><a name="line-122"></a><span>
</span><a name="line-123"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Pos.Util.Arbitrary.html#ArbitraryUnsafe"><span class="hs-identifier hs-type">ArbitraryUnsafe</span></a><span> </span><a href="#local-6989586621680694860"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Util.Arbitrary.html#ArbitraryUnsafe"><span class="hs-identifier hs-type">ArbitraryUnsafe</span></a><span> </span><a href="#local-6989586621680694861"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Pos.Util.Arbitrary.html#ArbitraryUnsafe"><span class="hs-identifier hs-type">ArbitraryUnsafe</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680694860"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680694861"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-124"></a><span>    </span><a name="local-8214565720325469671"><a href="Pos.Util.Arbitrary.html#arbitraryUnsafe"><span class="hs-identifier">arbitraryUnsafe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Pos.Util.Arbitrary.html#arbitraryUnsafe"><span class="hs-identifier hs-var">arbitraryUnsafe</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Pos.Util.Arbitrary.html#arbitraryUnsafe"><span class="hs-identifier hs-var">arbitraryUnsafe</span></a><span>
</span><a name="line-125"></a></pre></body></html>