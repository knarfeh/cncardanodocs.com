<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds           #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE KindSignatures      #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE Rank2Types          #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies        #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE TypeOperators       #-}</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-comment">-- | Servant API for wallet.</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Wallet</span><span class="hs-operator">.</span><span class="hs-identifier">Web</span><span class="hs-operator">.</span><span class="hs-identifier">Api</span><span>
</span><a name="line-11"></a><span>       </span><span class="hs-special">(</span><span> </span><a href="Pos.Wallet.Web.Api.html#WalletApi"><span class="hs-identifier hs-type">WalletApi</span></a><span>
</span><a name="line-12"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#walletApi"><span class="hs-identifier hs-var">walletApi</span></a><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#ApiPrefix"><span class="hs-identifier hs-type">ApiPrefix</span></a><span>
</span><a name="line-15"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#WalletVerb"><span class="hs-identifier hs-type">WalletVerb</span></a><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#TestReset"><span class="hs-identifier hs-type">TestReset</span></a><span>
</span><a name="line-18"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#TestState"><span class="hs-identifier hs-type">TestState</span></a><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#GetWallet"><span class="hs-identifier hs-type">GetWallet</span></a><span>
</span><a name="line-21"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#GetWallets"><span class="hs-identifier hs-type">GetWallets</span></a><span>
</span><a name="line-22"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#NewWallet"><span class="hs-identifier hs-type">NewWallet</span></a><span>
</span><a name="line-23"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#UpdateWallet"><span class="hs-identifier hs-type">UpdateWallet</span></a><span>
</span><a name="line-24"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#RestoreWallet"><span class="hs-identifier hs-type">RestoreWallet</span></a><span>
</span><a name="line-25"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#DeleteWallet"><span class="hs-identifier hs-type">DeleteWallet</span></a><span>
</span><a name="line-26"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#ImportWallet"><span class="hs-identifier hs-type">ImportWallet</span></a><span>
</span><a name="line-27"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#ChangeWalletPassphrase"><span class="hs-identifier hs-type">ChangeWalletPassphrase</span></a><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#GetAccount"><span class="hs-identifier hs-type">GetAccount</span></a><span>
</span><a name="line-30"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#GetAccounts"><span class="hs-identifier hs-type">GetAccounts</span></a><span>
</span><a name="line-31"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#UpdateAccount"><span class="hs-identifier hs-type">UpdateAccount</span></a><span>
</span><a name="line-32"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#DeleteAccount"><span class="hs-identifier hs-type">DeleteAccount</span></a><span>
</span><a name="line-33"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#NewAccount"><span class="hs-identifier hs-type">NewAccount</span></a><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#NewAddress"><span class="hs-identifier hs-type">NewAddress</span></a><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#IsValidAddress"><span class="hs-identifier hs-type">IsValidAddress</span></a><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#GetProfile"><span class="hs-identifier hs-type">GetProfile</span></a><span>
</span><a name="line-40"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#UpdateProfile"><span class="hs-identifier hs-type">UpdateProfile</span></a><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#NewPayment"><span class="hs-identifier hs-type">NewPayment</span></a><span>
</span><a name="line-43"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#NewPaymentBatch"><span class="hs-identifier hs-type">NewPaymentBatch</span></a><span>
</span><a name="line-44"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#TxFee"><span class="hs-identifier hs-type">TxFee</span></a><span>
</span><a name="line-45"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#CancelApplyingPtxs"><span class="hs-identifier hs-type">CancelApplyingPtxs</span></a><span>
</span><a name="line-46"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#CancelSpecificApplyingPtx"><span class="hs-identifier hs-type">CancelSpecificApplyingPtx</span></a><span>
</span><a name="line-47"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#UpdateTx"><span class="hs-identifier hs-type">UpdateTx</span></a><span>
</span><a name="line-48"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#GetHistory"><span class="hs-identifier hs-type">GetHistory</span></a><span>
</span><a name="line-49"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#GetPendingTxsSummary"><span class="hs-identifier hs-type">GetPendingTxsSummary</span></a><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#NextUpdate"><span class="hs-identifier hs-type">NextUpdate</span></a><span>
</span><a name="line-52"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#PostponeUpdate"><span class="hs-identifier hs-type">PostponeUpdate</span></a><span>
</span><a name="line-53"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#ApplyUpdate"><span class="hs-identifier hs-type">ApplyUpdate</span></a><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#RedeemADA"><span class="hs-identifier hs-type">RedeemADA</span></a><span>
</span><a name="line-56"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#RedeemADAPaperVend"><span class="hs-identifier hs-type">RedeemADAPaperVend</span></a><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#ReportingInitialized"><span class="hs-identifier hs-type">ReportingInitialized</span></a><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#GetSlotsDuration"><span class="hs-identifier hs-type">GetSlotsDuration</span></a><span>
</span><a name="line-61"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#GetVersion"><span class="hs-identifier hs-type">GetVersion</span></a><span>
</span><a name="line-62"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#GetSyncProgress"><span class="hs-identifier hs-type">GetSyncProgress</span></a><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#ImportBackupJSON"><span class="hs-identifier hs-type">ImportBackupJSON</span></a><span>
</span><a name="line-65"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#ExportBackupJSON"><span class="hs-identifier hs-type">ExportBackupJSON</span></a><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#GetClientInfo"><span class="hs-identifier hs-type">GetClientInfo</span></a><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#WalletSwaggerApi"><span class="hs-identifier hs-type">WalletSwaggerApi</span></a><span>
</span><a name="line-70"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Api.html#swaggerWalletApi"><span class="hs-identifier hs-var">swaggerWalletApi</span></a><span>
</span><a name="line-71"></a><span>       </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Lens</span><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">from</span><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Catch</span><span>         </span><span class="hs-special">(</span><span class="hs-identifier hs-var">try</span><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Reflection</span><span>             </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Reifies</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-77"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Servant</span><span class="hs-operator">.</span><span class="hs-identifier">API</span><span>                 </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-type">:&lt;|&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-type">:&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Capture</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Delete</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Get</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">JSON</span><span class="hs-special">,</span><span>
</span><a name="line-78"></a><span>                                              </span><span class="hs-identifier hs-type">Post</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Put</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">QueryParam</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ReflectMethod</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-79"></a><span>                                              </span><span class="hs-identifier hs-type">ReqBody</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Verb</span><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Servant</span><span class="hs-operator">.</span><span class="hs-identifier">API</span><span class="hs-operator">.</span><span class="hs-identifier">ContentTypes</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">OctetStream</span><span class="hs-special">)</span><span>
</span><a name="line-81"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Servant</span><span class="hs-operator">.</span><span class="hs-identifier">Server</span><span>              </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HasServer</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-82"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Servant</span><span class="hs-operator">.</span><span class="hs-identifier">Swagger</span><span class="hs-operator">.</span><span class="hs-identifier">UI</span><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SwaggerSchemaUI</span><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Universum</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-comment">-------</span><span>
</span><a name="line-86"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Client</span><span class="hs-operator">.</span><span class="hs-identifier">Txp</span><span class="hs-operator">.</span><span class="hs-identifier">Util</span><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-type">InputSelectionPolicy</span><span class="hs-special">)</span><span>
</span><a name="line-87"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span><span>                  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Coin</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">SoftwareVersion</span><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Util</span><span class="hs-operator">.</span><span class="hs-identifier">Servant</span><span>           </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ApiLoggingConfig</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CCapture</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CQueryParam</span><span class="hs-special">,</span><span>
</span><a name="line-89"></a><span>                                             </span><span class="hs-identifier hs-type">CReqBody</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">DCQueryParam</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">DReqBody</span><span class="hs-special">,</span><span>
</span><a name="line-90"></a><span>                                             </span><span class="hs-identifier hs-type">HasLoggingServer</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">LoggingApi</span><span class="hs-special">,</span><span>
</span><a name="line-91"></a><span>                                             </span><span class="hs-identifier hs-type">ModifiesApiRes</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ReportDecodeError</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-92"></a><span>                                             </span><span class="hs-identifier hs-type">VerbMod</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">WithTruncatedLog</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-93"></a><span>                                             </span><span class="hs-identifier hs-var">applyLoggingToHandler</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">inRouteServer</span><span class="hs-special">,</span><span>
</span><a name="line-94"></a><span>                                             </span><span class="hs-identifier hs-var">serverHandlerL'</span><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Wallet</span><span class="hs-operator">.</span><span class="hs-identifier">Web</span><span class="hs-operator">.</span><span class="hs-identifier">ClientTypes</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Addr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CAccount</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CAccountId</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CAccountInit</span><span class="hs-special">,</span><span>
</span><a name="line-96"></a><span>                                             </span><span class="hs-identifier hs-type">CAccountMeta</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CAddress</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CCoin</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CFilePath</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ClientInfo</span><span class="hs-special">,</span><span>
</span><a name="line-97"></a><span>                                             </span><span class="hs-identifier hs-type">CId</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CInitialized</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CPaperVendWalletRedeem</span><span class="hs-special">,</span><span>
</span><a name="line-98"></a><span>                                             </span><span class="hs-identifier hs-type">CPassPhrase</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CProfile</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CTx</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CTxId</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CTxMeta</span><span class="hs-special">,</span><span>
</span><a name="line-99"></a><span>                                             </span><span class="hs-identifier hs-type">CUpdateInfo</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CWallet</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CWalletInit</span><span class="hs-special">,</span><span>
</span><a name="line-100"></a><span>                                             </span><span class="hs-identifier hs-type">CWalletMeta</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CWalletRedeem</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ScrollLimit</span><span class="hs-special">,</span><span>
</span><a name="line-101"></a><span>                                             </span><span class="hs-identifier hs-type">ScrollOffset</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">NewBatchPayment</span><span class="hs-special">,</span><span>
</span><a name="line-102"></a><span>                                             </span><span class="hs-identifier hs-type">SyncProgress</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Wal</span><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Wallet</span><span class="hs-operator">.</span><span class="hs-identifier">Web</span><span class="hs-operator">.</span><span class="hs-identifier">Error</span><span>       </span><span class="hs-special">(</span><span class="hs-identifier hs-type">WalletError</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DecodeError</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-104"></a><span>                                             </span><span class="hs-identifier hs-var">catchEndpointErrors</span><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Wallet.Web.Methods.Misc.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Wallet</span><span class="hs-operator">.</span><span class="hs-identifier">Web</span><span class="hs-operator">.</span><span class="hs-identifier">Methods</span><span class="hs-operator">.</span><span class="hs-identifier">Misc</span></a><span> </span><span class="hs-special">(</span><a href="Pos.Wallet.Web.Methods.Misc.html#PendingTxsSummary"><span class="hs-identifier hs-type">PendingTxsSummary</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Wallet.Web.Methods.Misc.html#WalletStateSnapshot"><span class="hs-identifier hs-type">WalletStateSnapshot</span></a><span class="hs-special">)</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">-- | Common prefix for all endpoints.</span><span>
</span><a name="line-108"></a><span class="hs-keyword">type</span><span> </span><a name="ApiPrefix"><a href="Pos.Wallet.Web.Api.html#ApiPrefix"><span class="hs-identifier">ApiPrefix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;api&quot;</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-comment">-- | API result modification mode used here.</span><span>
</span><a name="line-111"></a><span class="hs-keyword">data</span><span> </span><a name="WalletVerbTag"><a href="Pos.Wallet.Web.Api.html#WalletVerbTag"><span class="hs-identifier">WalletVerbTag</span></a></a><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-comment">-- | Wrapper over 'Verb', which allows to catch exceptions thrown</span><span>
</span><a name="line-114"></a><span class="hs-comment">-- by endpoints.</span><span>
</span><a name="line-115"></a><span class="hs-keyword">type</span><span> </span><a name="WalletVerb"><a href="Pos.Wallet.Web.Api.html#WalletVerb"><span class="hs-identifier">WalletVerb</span></a></a><span> </span><a name="local-6989586621680238233"><a href="#local-6989586621680238233"><span class="hs-identifier">verb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">VerbMod</span><span> </span><a href="Pos.Wallet.Web.Api.html#WalletVerbTag"><span class="hs-identifier hs-type">WalletVerbTag</span></a><span> </span><a href="#local-6989586621680238233"><span class="hs-identifier hs-type">verb</span></a><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ModifiesApiRes</span><span> </span><a href="Pos.Wallet.Web.Api.html#WalletVerbTag"><span class="hs-identifier hs-type">WalletVerbTag</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-118"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">ApiModifiedRes</span><span> </span><a href="Pos.Wallet.Web.Api.html#WalletVerbTag"><span class="hs-identifier hs-type">WalletVerbTag</span></a><span> </span><a href="#local-6989586621680238396"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">WalletError</span><span> </span><a href="#local-6989586621680238396"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-119"></a><span>    </span><a name="local-8214565720323797172"><span class="hs-identifier">modifyApiResult</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">try</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">catchEndpointErrors</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">throwM</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ReportDecodeError</span><span> </span><span class="hs-special">(</span><a href="Pos.Wallet.Web.Api.html#WalletVerb"><span class="hs-identifier hs-type">WalletVerb</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Verb</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680238244"><span class="hs-identifier hs-type">mt</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621680238243"><span class="hs-identifier hs-type">k1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680238245"><span class="hs-identifier hs-type">st</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Nat</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680238246"><span class="hs-identifier hs-type">ct</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-operator hs-type">*</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680238247"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-122"></a><span>    </span><a name="local-8214565720323797181"><span class="hs-identifier">reportDecodeError</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680238248"><a href="#local-6989586621680238248"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">throwM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DecodeError</span><span> </span><a href="#local-6989586621680238248"><span class="hs-identifier hs-var">err</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">^.</span><span> </span><span class="hs-identifier hs-var">from</span><span> </span><span class="hs-identifier hs-var">serverHandlerL'</span><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">HasServer</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Verb</span><span> </span><a href="#local-6989586621680238235"><span class="hs-identifier hs-type">mt</span></a><span> </span><a href="#local-6989586621680238236"><span class="hs-identifier hs-type">st</span></a><span> </span><a href="#local-6989586621680238237"><span class="hs-identifier hs-type">ct</span></a><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier hs-type">ApiModifiedRes</span><span> </span><a href="Pos.Wallet.Web.Api.html#WalletVerbTag"><span class="hs-identifier hs-type">WalletVerbTag</span></a><span> </span><a href="#local-6989586621680238238"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680238239"><span class="hs-identifier hs-type">ctx</span></a><span>
</span><a name="line-125"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Reifies</span><span> </span><a href="#local-6989586621680238240"><span class="hs-identifier hs-type">config</span></a><span> </span><span class="hs-identifier hs-type">ApiLoggingConfig</span><span>
</span><a name="line-126"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ReflectMethod</span><span> </span><a href="#local-6989586621680238235"><span class="hs-identifier hs-type">mt</span></a><span>
</span><a name="line-127"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">WithTruncatedLog</span><span> </span><a href="#local-6989586621680238238"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-129"></a><span>         </span><span class="hs-identifier hs-type">HasLoggingServer</span><span> </span><a href="#local-6989586621680238240"><span class="hs-identifier hs-type">config</span></a><span> </span><span class="hs-special">(</span><a href="Pos.Wallet.Web.Api.html#WalletVerb"><span class="hs-identifier hs-type">WalletVerb</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Verb</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680238235"><span class="hs-identifier hs-type">mt</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621680238234"><span class="hs-identifier hs-type">k1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680238236"><span class="hs-identifier hs-type">st</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Nat</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680238237"><span class="hs-identifier hs-type">ct</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-operator hs-type">*</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680238238"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680238239"><span class="hs-identifier hs-type">ctx</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-130"></a><span>    </span><a name="local-8214565720323797152"><span class="hs-identifier">routeWithLog</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-131"></a><span>        </span><span class="hs-comment">-- TODO [CSM-466] avoid manually rewriting rule for composite api modification</span><span>
</span><a name="line-132"></a><span>        </span><span class="hs-identifier hs-var">inRouteServer</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Verb</span><span> </span><a href="#local-6989586621680238235"><span class="hs-identifier hs-type">mt</span></a><span> </span><a href="#local-6989586621680238236"><span class="hs-identifier hs-type">st</span></a><span> </span><a href="#local-6989586621680238237"><span class="hs-identifier hs-type">ct</span></a><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier hs-type">ApiModifiedRes</span><span> </span><a href="Pos.Wallet.Web.Api.html#WalletVerbTag"><span class="hs-identifier hs-type">WalletVerbTag</span></a><span> </span><a href="#local-6989586621680238238"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">route</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-133"></a><span>        </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621680238241"><a href="#local-6989586621680238241"><span class="hs-identifier">paramsInfo</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680238242"><a href="#local-6989586621680238242"><span class="hs-identifier">handler</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-134"></a><span>            </span><a href="#local-6989586621680238242"><span class="hs-identifier hs-var">handler</span></a><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">serverHandlerL'</span><span> </span><span class="hs-operator hs-var">%~</span><span> </span><span class="hs-identifier hs-var">modifyApiResult</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><a href="Pos.Wallet.Web.Api.html#WalletVerbTag"><span class="hs-identifier hs-type">WalletVerbTag</span></a><span class="hs-special">)</span><span>
</span><a name="line-135"></a><span>                    </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">applyLoggingToHandler</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621680238240"><span class="hs-identifier hs-type">config</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621680238235"><span class="hs-identifier hs-type">mt</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680238241"><span class="hs-identifier hs-var">paramsInfo</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span class="hs-comment">-- | Specifes servant logging config.</span><span>
</span><a name="line-138"></a><span class="hs-keyword">data</span><span> </span><a name="WalletLoggingConfig"><a href="Pos.Wallet.Web.Api.html#WalletLoggingConfig"><span class="hs-identifier">WalletLoggingConfig</span></a></a><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-comment">-- If logger config will ever be determined in runtime, 'Data.Reflection.reify'</span><span>
</span><a name="line-141"></a><span class="hs-comment">-- can be used.</span><span>
</span><a name="line-142"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Reifies</span><span> </span><a href="Pos.Wallet.Web.Api.html#WalletLoggingConfig"><span class="hs-identifier hs-type">WalletLoggingConfig</span></a><span> </span><span class="hs-identifier hs-type">ApiLoggingConfig</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-143"></a><span>    </span><a name="local-8214565720323819471"><span class="hs-identifier">reflect</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;node&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;wallet&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;servant&quot;</span><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-comment">-- | Shortcut for common api result types.</span><span>
</span><a name="line-146"></a><span class="hs-keyword">type</span><span> </span><a name="WRes"><a href="Pos.Wallet.Web.Api.html#WRes"><span class="hs-identifier">WRes</span></a></a><span> </span><a name="local-6989586621680238231"><a href="#local-6989586621680238231"><span class="hs-identifier">verbType</span></a></a><span> </span><a name="local-6989586621680238232"><a href="#local-6989586621680238232"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Wallet.Web.Api.html#WalletVerb"><span class="hs-identifier hs-type">WalletVerb</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680238231"><span class="hs-identifier hs-type">verbType</span></a><span> </span><span class="hs-char">'[JSON] a)

-- All endpoints are defined as a separate types, for description in Swagger-based HTML-documentation.

type TestReset =
       &quot;test&quot;
    :&gt; &quot;reset&quot;
    :&gt; WRes Post ()

type TestState =
       &quot;test&quot;
    :&gt; &quot;state&quot;
    :&gt; Get '[OctetStream] WalletStateSnapshot

-------------------------------------------------------------------------
-- Wallets
-------------------------------------------------------------------------

type GetWallet =
       &quot;wallets&quot;
    :&gt; Capture &quot;walletId&quot; (CId Wal)
    :&gt; WRes Get CWallet

type GetWallets =
       &quot;wallets&quot;
    :&gt; WRes Get [CWallet]

type NewWallet =
       &quot;wallets&quot;
    :&gt; &quot;new&quot;
    :&gt; DCQueryParam &quot;passphrase&quot; CPassPhrase
    :&gt; ReqBody '[JSON] CWalletInit
    :&gt; WRes Post CWallet

type UpdateWallet =
       &quot;wallets&quot;
    :&gt; Capture &quot;walletId&quot; (CId Wal)
    :&gt; ReqBody '[JSON] CWalletMeta
    :&gt; WRes Put CWallet

type RestoreWallet =
       &quot;wallets&quot;
    :&gt; &quot;restore&quot;
    :&gt; DCQueryParam &quot;passphrase&quot; CPassPhrase
    :&gt; ReqBody '[JSON] CWalletInit
    :&gt; WRes Post CWallet

type DeleteWallet =
       &quot;wallets&quot;
    :&gt; Capture &quot;walletId&quot; (CId Wal)
    :&gt; WRes Delete ()

type ImportWallet =
       &quot;wallets&quot;
    :&gt; &quot;keys&quot;
    :&gt; DCQueryParam &quot;passphrase&quot; CPassPhrase
    :&gt; ReqBody '[JSON] CFilePath
    :&gt; WRes Post CWallet

type ChangeWalletPassphrase =
       &quot;wallets&quot;
    :&gt; &quot;password&quot;
    :&gt; Capture &quot;walletId&quot; (CId Wal)
    :&gt; DCQueryParam &quot;old&quot; CPassPhrase
    :&gt; DCQueryParam &quot;new&quot; CPassPhrase
    :&gt; WRes Post ()

-------------------------------------------------------------------------
-- Accounts
-------------------------------------------------------------------------

type GetAccount =
       &quot;accounts&quot;
    :&gt; CCapture &quot;accountId&quot; CAccountId
    :&gt; WRes Get CAccount

type GetAccounts =
       &quot;accounts&quot;
    :&gt; QueryParam &quot;accountId&quot; (CId Wal)
    :&gt; WRes Get [CAccount]

type UpdateAccount =
       &quot;accounts&quot;
    :&gt; CCapture &quot;accountId&quot; CAccountId
    :&gt; ReqBody '[JSON] CAccountMeta
    :&gt; WRes Put CAccount

type NewAccount =
       &quot;accounts&quot;
    :&gt; DCQueryParam &quot;passphrase&quot; CPassPhrase
    :&gt; ReqBody '[JSON] CAccountInit
    :&gt; WRes Post CAccount

type DeleteAccount =
       &quot;accounts&quot;
    :&gt; CCapture &quot;accountId&quot; CAccountId
    :&gt; WRes Delete ()

-------------------------------------------------------------------------
-- Wallet addresses
-------------------------------------------------------------------------

type NewAddress =
       &quot;addresses&quot;
    :&gt; DCQueryParam &quot;passphrase&quot; CPassPhrase
    :&gt; CReqBody '[JSON] CAccountId
    :&gt; WRes Post CAddress

-------------------------------------------------------------------------
-- Addresses
-------------------------------------------------------------------------

type IsValidAddress =
       &quot;addresses&quot;
    :&gt; Capture &quot;address&quot; (CId Addr)  -- exact type of 'CId' shouldn't matter
    :&gt; WRes Get Bool

-------------------------------------------------------------------------
-- Profile(s)
-------------------------------------------------------------------------

type GetProfile =
       &quot;profile&quot;
    :&gt; WRes Get CProfile

type UpdateProfile =
       &quot;profile&quot;
    :&gt; ReqBody '[JSON] CProfile
    :&gt; WRes Post CProfile

-------------------------------------------------------------------------
-- Transactions
-------------------------------------------------------------------------

type NewPayment =
       &quot;txs&quot;
    :&gt; &quot;payments&quot;
    :&gt; DCQueryParam &quot;passphrase&quot; CPassPhrase
    :&gt; CCapture &quot;from&quot; CAccountId
    :&gt; Capture &quot;to&quot; (CId Addr)
    :&gt; Capture &quot;amount&quot; Coin
    :&gt; DReqBody '[JSON] (Maybe InputSelectionPolicy)
    :&gt; WRes Post CTx

type NewPaymentBatch =
       &quot;txs&quot;
    :&gt; &quot;payments&quot;
    :&gt; &quot;batch&quot;
    :&gt; DCQueryParam &quot;passphrase&quot; CPassPhrase
    :&gt; ReqBody '[JSON] NewBatchPayment
    :&gt; WRes Post CTx

type TxFee =
       &quot;txs&quot;
    :&gt; &quot;fee&quot;
    :&gt; CCapture &quot;from&quot; CAccountId
    :&gt; Capture &quot;to&quot; (CId Addr)
    :&gt; Capture &quot;amount&quot; Coin
    :&gt; DReqBody '[JSON] (Maybe InputSelectionPolicy)
    :&gt; WRes Post CCoin

type UpdateTx =
       &quot;txs&quot;
    :&gt; &quot;payments&quot;
    :&gt; CCapture &quot;address&quot; CAccountId
    :&gt; Capture &quot;transaction&quot; CTxId
    :&gt; ReqBody '[JSON] CTxMeta
    :&gt; WRes Post ()

type CancelApplyingPtxs =
       &quot;txs&quot;
    :&gt; &quot;resubmission&quot;
    :&gt; &quot;cancel&quot;
    :&gt; WRes Post ()

type CancelSpecificApplyingPtx =
       &quot;txs&quot;
    :&gt; &quot;resubmission&quot;
    :&gt; &quot;cancelsingle&quot;
    :&gt; Capture &quot;transaction&quot; CTxId
    :&gt; WRes Post ()

type GetHistory =
       &quot;txs&quot;
    :&gt; &quot;histories&quot;
    :&gt; QueryParam &quot;walletId&quot; (CId Wal)
    :&gt; CQueryParam &quot;accountId&quot; CAccountId
    :&gt; QueryParam &quot;address&quot; (CId Addr)
    :&gt; QueryParam &quot;skip&quot; ScrollOffset
    :&gt; QueryParam &quot;limit&quot; ScrollLimit
    :&gt; WRes Get ([CTx], Word)

type GetPendingTxsSummary =
        &quot;txs&quot;
    :&gt; &quot;pending&quot;
    :&gt; &quot;summary&quot;
    :&gt; WRes Get [PendingTxsSummary]

-------------------------------------------------------------------------
-- Updates
-------------------------------------------------------------------------

type NextUpdate =
       &quot;update&quot;
    :&gt; WRes Get CUpdateInfo

type PostponeUpdate =
       &quot;update&quot;
    :&gt; &quot;postpone&quot;
    :&gt; WRes Post ()

type ApplyUpdate =
       &quot;update&quot;
    :&gt; &quot;apply&quot;
    :&gt; WRes Post ()

-------------------------------------------------------------------------
-- Redemptions
-------------------------------------------------------------------------

type RedeemADA =
       &quot;redemptions&quot;
    :&gt; &quot;ada&quot;
    :&gt; DCQueryParam &quot;passphrase&quot; CPassPhrase
    :&gt; ReqBody '[JSON] CWalletRedeem
    :&gt; WRes Post CTx

type RedeemADAPaperVend =
       &quot;papervend&quot;
    :&gt; &quot;redemptions&quot;
    :&gt; &quot;ada&quot;
    :&gt; DCQueryParam &quot;passphrase&quot; CPassPhrase
    :&gt; ReqBody '[JSON] CPaperVendWalletRedeem
    :&gt; WRes Post CTx

-------------------------------------------------------------------------
-- Reporting
-------------------------------------------------------------------------

type ReportingInitialized =
       &quot;reporting&quot;
    :&gt; &quot;initialized&quot;
    :&gt; ReqBody '[JSON] CInitialized
    :&gt; WRes Post ()

-------------------------------------------------------------------------
-- Settings
-------------------------------------------------------------------------

type GetSlotsDuration =
       &quot;settings&quot;
    :&gt; &quot;slots&quot;
    :&gt; &quot;duration&quot;
    :&gt; WRes Get Word

type GetVersion =
       &quot;settings&quot;
    :&gt; &quot;version&quot;
    :&gt; WRes Get SoftwareVersion

type GetSyncProgress =
       &quot;settings&quot;
    :&gt; &quot;sync&quot;
    :&gt; &quot;progress&quot;
    :&gt; WRes Get SyncProgress

-------------------------------------------------------------------------
-- JSON backup
-------------------------------------------------------------------------

type ImportBackupJSON =
       &quot;backup&quot;
    :&gt; &quot;import&quot;
    :&gt; ReqBody '[JSON] CFilePath
    :&gt; WRes Post CWallet

type ExportBackupJSON =
       &quot;backup&quot;
    :&gt; &quot;export&quot;
    :&gt; Capture &quot;walletId&quot; (CId Wal)
    :&gt; ReqBody '[JSON] CFilePath
    :&gt; WRes Post ()

-------------------------------------------------------------------------
-- Settings
-------------------------------------------------------------------------

type GetClientInfo =
       &quot;info&quot;
    :&gt; WRes Get ClientInfo

-- | Servant API which provides access to wallet.
-- TODO: Should be composed depending on the resource - wallets, txs, ... http://haskell-servant.github.io/tutorial/0.4/server.html#nested-apis
type WalletApi = ApiPrefix :&gt; (
     -- NOTE: enabled in prod mode https://issues.serokell.io/issue/CSM-333
     TestReset
    :&lt;|&gt;
     TestState
    :&lt;|&gt;
     -------------------------------------------------------------------------
     -- Wallets
     -------------------------------------------------------------------------
     GetWallet
    :&lt;|&gt;
     GetWallets
    :&lt;|&gt;
     NewWallet
    :&lt;|&gt;
     UpdateWallet
    :&lt;|&gt;
     RestoreWallet
    :&lt;|&gt;
     DeleteWallet
    :&lt;|&gt;
     ImportWallet
    :&lt;|&gt;
     ChangeWalletPassphrase
    :&lt;|&gt;
     -------------------------------------------------------------------------
     -- Accounts
     -------------------------------------------------------------------------
     GetAccount
    :&lt;|&gt;
     GetAccounts
    :&lt;|&gt;
     UpdateAccount
    :&lt;|&gt;
     NewAccount
    :&lt;|&gt;
     DeleteAccount
    :&lt;|&gt;
     -------------------------------------------------------------------------
     -- Walllet addresses
     -------------------------------------------------------------------------
     NewAddress
    :&lt;|&gt;
     -------------------------------------------------------------------------
     -- Addresses
     -------------------------------------------------------------------------
     IsValidAddress
    :&lt;|&gt;
     -------------------------------------------------------------------------
     -- Profile(s)
     -------------------------------------------------------------------------
     -- TODO: A single profile? Should be possible in the future to have
     -- multiple profiles?
     GetProfile
    :&lt;|&gt;
     UpdateProfile
    :&lt;|&gt;
     -------------------------------------------------------------------------
     -- Transactons
     -------------------------------------------------------------------------
    -- TODO: for now we only support one2one sending. We should extend this
    -- to support many2many
     NewPayment
    :&lt;|&gt;
     NewPaymentBatch
    :&lt;|&gt;
     TxFee
    :&lt;|&gt;
     CancelApplyingPtxs
    :&lt;|&gt;
     CancelSpecificApplyingPtx
    :&lt;|&gt;
      -- FIXME: Should capture the URL parameters in the payload.
     UpdateTx
    :&lt;|&gt;
     GetHistory
    :&lt;|&gt;
     GetPendingTxsSummary
    :&lt;|&gt;
     -------------------------------------------------------------------------
     -- Updates
     -------------------------------------------------------------------------
     NextUpdate
    :&lt;|&gt;
     PostponeUpdate
    :&lt;|&gt;
     ApplyUpdate
    :&lt;|&gt;
     -------------------------------------------------------------------------
     -- Redemptions
     -------------------------------------------------------------------------
     RedeemADA
    :&lt;|&gt;
     RedeemADAPaperVend
    :&lt;|&gt;
     -------------------------------------------------------------------------
     -- Reporting
     -------------------------------------------------------------------------
     ReportingInitialized
    :&lt;|&gt;
     -------------------------------------------------------------------------
     -- Settings
     -------------------------------------------------------------------------
     GetSlotsDuration
    :&lt;|&gt;
     GetVersion
    :&lt;|&gt;
     GetSyncProgress
    :&lt;|&gt;
     -------------------------------------------------------------------------
     -- JSON backup
     -------------------------------------------------------------------------
     ImportBackupJSON
    :&lt;|&gt;
     ExportBackupJSON
    :&lt;|&gt;
     -------------------------------------------------------------------------
     -- Client info: various versions
     -------------------------------------------------------------------------
     GetClientInfo
    )

-- | Helper Proxy.
walletApi :: Proxy WalletApi
walletApi = Proxy

-------------------------------------------------------------------------
-- Swagger
-------------------------------------------------------------------------
type SwaggerApi =
    -- this serves both: swagger.json and swagger-ui
    SwaggerSchemaUI &quot;docs&quot; &quot;swagger.json&quot;

type WalletSwaggerApi =
     LoggingApi WalletLoggingConfig WalletApi
    :&lt;|&gt;
     SwaggerApi

-- | Helper Proxy.
swaggerWalletApi :: Proxy WalletSwaggerApi
swaggerWalletApi = Proxy
</span></pre></body></html>