<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Pos.Txp.Toil.Utxo.Functions</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Pos-Txp-Toil-Utxo-Functions.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Pos.Txp.Toil.Utxo.Functions.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">cardano-sl-txp-1.0.3: Cardano SL - transaction processing</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Pos.Txp.Toil.Utxo.Functions</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Functions operating on UTXO.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:VTxContext">VTxContext</a> = <a href="#v:VTxContext">VTxContext</a> {<ul class="subs"><li><a href="#v:vtcVerifyAllIsKnown">vtcVerifyAllIsKnown</a> :: !<a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></li></ul>}</li><li class="src short"><a href="#v:verifyTxUtxo">verifyTxUtxo</a> :: (<a href="Pos-Txp-Toil-Class.html#t:MonadUtxoRead">MonadUtxoRead</a> m, MonadError <a href="Pos-Txp-Toil-Failure.html#t:ToilVerFailure">ToilVerFailure</a> m) =&gt; <a href="Pos-Txp-Toil-Utxo-Functions.html#t:VTxContext">VTxContext</a> -&gt; <a href="Pos-Txp-Core-Types.html#t:TxAux">TxAux</a> -&gt; m (<a href="Pos-Txp-Core-Types.html#t:TxUndo">TxUndo</a>, <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Txp-Toil-Types.html#t:TxFee">TxFee</a>)</li><li class="src short"><a href="#v:applyTxToUtxo">applyTxToUtxo</a> :: <a href="Pos-Txp-Toil-Class.html#t:MonadUtxo">MonadUtxo</a> m =&gt; <a href="../cardano-sl-core-1.0.3/Pos-Crypto-Hashing.html#t:WithHash">WithHash</a> <a href="Pos-Txp-Core-Types.html#t:Tx">Tx</a> -&gt; m ()</li><li class="src short"><a href="#v:rollbackTxUtxo">rollbackTxUtxo</a> :: <a href="Pos-Txp-Toil-Class.html#t:MonadUtxo">MonadUtxo</a> m =&gt; (<a href="Pos-Txp-Core-Types.html#t:TxAux">TxAux</a>, <a href="Pos-Txp-Core-Types.html#t:TxUndo">TxUndo</a>) -&gt; m ()</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:VTxContext" class="def">VTxContext</a> <a href="src/Pos.Txp.Toil.Utxo.Functions.html#VTxContext" class="link">Source</a> <a href="#t:VTxContext" class="selflink">#</a></p><div class="doc"><p>Global context data needed for tx verification. VT stands for
 &quot;Verify Tx&quot;. To be populated in further versions.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:VTxContext" class="def">VTxContext</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:vtcVerifyAllIsKnown" class="def">vtcVerifyAllIsKnown</a> :: !<a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></dfn><div class="doc"><p>Verify that script versions in tx are known, addresses' and
 witnesses' types are known, attributes are known too.</p></div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:VTxContext" class="caption collapser" onclick="toggleSection('i:VTxContext')">Instances</p><div id="section.i:VTxContext" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:VTxContext:Show:1" class="instance expander" onclick="toggleSection('i:id:VTxContext:Show:1')"></span> <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> <a href="Pos-Txp-Toil-Utxo-Functions.html#t:VTxContext">VTxContext</a></span> <a href="src/Pos.Txp.Toil.Utxo.Functions.html#line-55" class="link">Source</a> <a href="#t:VTxContext" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:VTxContext:Show:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Pos-Txp-Toil-Utxo-Functions.html#t:VTxContext">VTxContext</a> -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Pos-Txp-Toil-Utxo-Functions.html#t:VTxContext">VTxContext</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Pos-Txp-Toil-Utxo-Functions.html#t:VTxContext">VTxContext</a>] -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><a id="v:verifyTxUtxo" class="def">verifyTxUtxo</a> :: (<a href="Pos-Txp-Toil-Class.html#t:MonadUtxoRead">MonadUtxoRead</a> m, MonadError <a href="Pos-Txp-Toil-Failure.html#t:ToilVerFailure">ToilVerFailure</a> m) =&gt; <a href="Pos-Txp-Toil-Utxo-Functions.html#t:VTxContext">VTxContext</a> -&gt; <a href="Pos-Txp-Core-Types.html#t:TxAux">TxAux</a> -&gt; m (<a href="Pos-Txp-Core-Types.html#t:TxUndo">TxUndo</a>, <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pos-Txp-Toil-Types.html#t:TxFee">TxFee</a>) <a href="src/Pos.Txp.Toil.Utxo.Functions.html#verifyTxUtxo" class="link">Source</a> <a href="#v:verifyTxUtxo" class="selflink">#</a></p><div class="doc"><p>CHECK: Verify Tx correctness using <code><a href="Pos-Txp-Toil-Class.html#t:MonadUtxoRead">MonadUtxoRead</a></code>.
 Specifically there are the following checks:</p><ul><li>every input is a known unspent output;</li><li>sum of inputs &gt;= sum of outputs;</li><li>every input has a proper witness verifying that input;</li><li>script witnesses have matching script versions;</li><li>if <code><a href="Pos-Txp-Toil-Utxo-Functions.html#v:vtcVerifyAllIsKnown">vtcVerifyAllIsKnown</a></code> is <code><a href="../base-4.9.1.0/Data-Bool.html#v:True">True</a></code>, addresses' versions are verified
   to be known, as well as witnesses, attributes, script versions.</li></ul><p>Note that <code><a href="Pos-Txp-Toil-Utxo-Functions.html#v:verifyTxUtxo">verifyTxUtxo</a></code> doesn't attempt to verify scripts with
 versions higher than maximum script version we can handle. That's
 because we want blocks with such transactions to be accepted (to
 avoid hard forks). However, we won't include such transactions into
 blocks when we're creating a block (because transactions for
 inclusion into blocks are verified with <code><a href="Pos-Txp-Toil-Utxo-Functions.html#v:vtcVerifyAllIsKnown">vtcVerifyAllIsKnown</a></code>
 set to <code><a href="../base-4.9.1.0/Data-Bool.html#v:True">True</a></code>, so unknown script versions are rejected).</p><p>Returned fee can be <code><a href="../base-4.9.1.0/Data-Maybe.html#v:Nothing">Nothing</a></code> if there are inputs of unknown types.</p></div></div><div class="top"><p class="src"><a id="v:applyTxToUtxo" class="def">applyTxToUtxo</a> :: <a href="Pos-Txp-Toil-Class.html#t:MonadUtxo">MonadUtxo</a> m =&gt; <a href="../cardano-sl-core-1.0.3/Pos-Crypto-Hashing.html#t:WithHash">WithHash</a> <a href="Pos-Txp-Core-Types.html#t:Tx">Tx</a> -&gt; m () <a href="src/Pos.Txp.Toil.Utxo.Functions.html#applyTxToUtxo" class="link">Source</a> <a href="#v:applyTxToUtxo" class="selflink">#</a></p><div class="doc"><p>Remove unspent outputs used in given transaction, add new unspent
 outputs.</p></div></div><div class="top"><p class="src"><a id="v:rollbackTxUtxo" class="def">rollbackTxUtxo</a> :: <a href="Pos-Txp-Toil-Class.html#t:MonadUtxo">MonadUtxo</a> m =&gt; (<a href="Pos-Txp-Core-Types.html#t:TxAux">TxAux</a>, <a href="Pos-Txp-Core-Types.html#t:TxUndo">TxUndo</a>) -&gt; m () <a href="src/Pos.Txp.Toil.Utxo.Functions.html#rollbackTxUtxo" class="link">Source</a> <a href="#v:rollbackTxUtxo" class="selflink">#</a></p><div class="doc"><p>Rollback application of given transaction to Utxo using Undo
 data.  This function assumes that transaction has been really
 applied and doesn't check anything.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.3</p></div></body></html>