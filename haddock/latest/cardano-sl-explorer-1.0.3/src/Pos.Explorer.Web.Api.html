<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds     #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><a name="line-3"></a><span>
</span><a name="line-4"></a><span class="hs-comment">-- | Servant API for explorer</span><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Explorer</span><span class="hs-operator">.</span><span class="hs-identifier">Web</span><span class="hs-operator">.</span><span class="hs-identifier">Api</span><span>
</span><a name="line-7"></a><span>       </span><span class="hs-special">(</span><span> </span><a href="Pos.Explorer.Web.Api.html#ExplorerApi"><span class="hs-identifier hs-type">ExplorerApi</span></a><span>
</span><a name="line-8"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Explorer.Web.Api.html#explorerApi"><span class="hs-identifier hs-var">explorerApi</span></a><span>
</span><a name="line-9"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Explorer.Web.Api.html#BlocksPages"><span class="hs-identifier hs-type">BlocksPages</span></a><span>
</span><a name="line-10"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Explorer.Web.Api.html#BlocksPagesTotal"><span class="hs-identifier hs-type">BlocksPagesTotal</span></a><span>
</span><a name="line-11"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Explorer.Web.Api.html#BlocksSummary"><span class="hs-identifier hs-type">BlocksSummary</span></a><span>
</span><a name="line-12"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Explorer.Web.Api.html#BlocksTxs"><span class="hs-identifier hs-type">BlocksTxs</span></a><span>
</span><a name="line-13"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Explorer.Web.Api.html#TxsLast"><span class="hs-identifier hs-type">TxsLast</span></a><span>
</span><a name="line-14"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Explorer.Web.Api.html#TxsSummary"><span class="hs-identifier hs-type">TxsSummary</span></a><span>
</span><a name="line-15"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Explorer.Web.Api.html#AddressSummary"><span class="hs-identifier hs-type">AddressSummary</span></a><span>
</span><a name="line-16"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Explorer.Web.Api.html#EpochPages"><span class="hs-identifier hs-type">EpochPages</span></a><span>
</span><a name="line-17"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Pos.Explorer.Web.Api.html#EpochSlots"><span class="hs-identifier hs-type">EpochSlots</span></a><span>
</span><a name="line-18"></a><span>       </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Universum</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Proxy</span><span>                   </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Proxy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Explorer.Web.ClientTypes.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Explorer</span><span class="hs-operator">.</span><span class="hs-identifier">Web</span><span class="hs-operator">.</span><span class="hs-identifier">ClientTypes</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Byte</span><span class="hs-special">,</span><span> </span><a href="Pos.Explorer.Web.ClientTypes.html#CAda"><span class="hs-identifier hs-type">CAda</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Explorer.Web.ClientTypes.html#CAddress"><span class="hs-identifier hs-type">CAddress</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Explorer.Web.ClientTypes.html#CAddressSummary"><span class="hs-identifier hs-type">CAddressSummary</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>                                               </span><a href="Pos.Explorer.Web.ClientTypes.html#CAddressesFilter"><span class="hs-identifier hs-type">CAddressesFilter</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Explorer.Web.ClientTypes.html#CBlockEntry"><span class="hs-identifier hs-type">CBlockEntry</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Explorer.Web.ClientTypes.html#CBlockSummary"><span class="hs-identifier hs-type">CBlockSummary</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>                                               </span><a href="Pos.Explorer.Web.ClientTypes.html#CGenesisAddressInfo"><span class="hs-identifier hs-type">CGenesisAddressInfo</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Explorer.Web.ClientTypes.html#CGenesisSummary"><span class="hs-identifier hs-type">CGenesisSummary</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>                                               </span><a href="Pos.Explorer.Web.ClientTypes.html#CHash"><span class="hs-identifier hs-type">CHash</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Explorer.Web.ClientTypes.html#CTxBrief"><span class="hs-identifier hs-type">CTxBrief</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Explorer.Web.ClientTypes.html#CTxEntry"><span class="hs-identifier hs-type">CTxEntry</span></a><span class="hs-special">,</span><span> </span><a href="Pos.Explorer.Web.ClientTypes.html#CTxId"><span class="hs-identifier hs-type">CTxId</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>                                               </span><a href="Pos.Explorer.Web.ClientTypes.html#CTxSummary"><span class="hs-identifier hs-type">CTxSummary</span></a><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span>           </span><a href="Pos.Explorer.Web.Error.html"><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Explorer</span><span class="hs-operator">.</span><span class="hs-identifier">Web</span><span class="hs-operator">.</span><span class="hs-identifier">Error</span></a><span>       </span><span class="hs-special">(</span><a href="Pos.Explorer.Web.Error.html#ExplorerError"><span class="hs-identifier hs-type">ExplorerError</span></a><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Pos</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">EpochIndex</span><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Servant</span><span class="hs-operator">.</span><span class="hs-identifier">API</span><span>                  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-type">:&lt;|&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-type">:&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Capture</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Get</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">JSON</span><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>                                               </span><span class="hs-identifier hs-type">QueryParam</span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-keyword">type</span><span> </span><a name="PageNumber"><a href="Pos.Explorer.Web.Api.html#PageNumber"><span class="hs-identifier">PageNumber</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-comment">-- | Common prefix for all endpoints.</span><span>
</span><a name="line-38"></a><span class="hs-keyword">type</span><span> </span><a name="API"><a href="Pos.Explorer.Web.Api.html#API"><span class="hs-identifier">API</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;api&quot;</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-keyword">type</span><span> </span><a name="TotalAda"><a href="Pos.Explorer.Web.Api.html#TotalAda"><span class="hs-identifier">TotalAda</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pos.Explorer.Web.Api.html#API"><span class="hs-identifier hs-type">API</span></a><span>
</span><a name="line-41"></a><span>    </span><span class="hs-operator">:&gt;</span><span> </span><span class="hs-string">&quot;supply&quot;</span><span>
</span><a name="line-42"></a><span>    </span><span class="hs-operator">:&gt;</span><span> </span><span class="hs-string">&quot;ada&quot;</span><span>
</span><a name="line-43"></a><span>    </span><span class="hs-operator">:&gt;</span><span> </span><span class="hs-identifier hs-type">Get</span><span> </span><span class="hs-char">'[JSON] (Either ExplorerError CAda)

type BlocksPages = API
    :&gt; &quot;blocks&quot;
    :&gt; &quot;pages&quot;
    :&gt; QueryParam &quot;page&quot; Word
    :&gt; QueryParam &quot;pageSize&quot; Word
    :&gt; Get '[JSON] (Either ExplorerError (PageNumber, [CBlockEntry]))

type BlocksPagesTotal = API
    :&gt; &quot;blocks&quot;
    :&gt; &quot;pages&quot;
    :&gt; &quot;total&quot;
    :&gt; QueryParam &quot;pageSize&quot; Word
    :&gt; Get '[JSON] (Either ExplorerError PageNumber)

type BlocksSummary = API
    :&gt; &quot;blocks&quot;
    :&gt; &quot;summary&quot;
    :&gt; Capture &quot;hash&quot; CHash
    :&gt; Get '[JSON] (Either ExplorerError CBlockSummary)

type BlocksTxs = API
    :&gt; &quot;blocks&quot;
    :&gt; &quot;txs&quot;
    :&gt; Capture &quot;hash&quot; CHash
    :&gt; QueryParam &quot;limit&quot; Word
    :&gt; QueryParam &quot;offset&quot; Word
    :&gt; Get '[JSON] (Either ExplorerError [CTxBrief])

type TxsLast = API
    :&gt; &quot;txs&quot;
    :&gt; &quot;last&quot;
    :&gt; Get '[JSON] (Either ExplorerError [CTxEntry])

type TxsSummary = API
    :&gt; &quot;txs&quot;
    :&gt; &quot;summary&quot;
    :&gt; Capture &quot;txid&quot; CTxId
    :&gt; Get '[JSON] (Either ExplorerError CTxSummary)

type AddressSummary = API
    :&gt; &quot;addresses&quot;
    :&gt; &quot;summary&quot;
    :&gt; Capture &quot;address&quot; CAddress
    :&gt; Get '[JSON] (Either ExplorerError CAddressSummary)

type EpochPages = API
    :&gt; &quot;epochs&quot;
    :&gt; Capture &quot;epoch&quot; EpochIndex
    :&gt; QueryParam &quot;page&quot; Int
    :&gt; Get '[JSON] (Either ExplorerError (Int, [CBlockEntry]))

type EpochSlots = API
    :&gt; &quot;epochs&quot;
    :&gt; Capture &quot;epoch&quot; EpochIndex
    :&gt; Capture &quot;slot&quot; Word16
    :&gt; Get '[JSON] (Either ExplorerError [CBlockEntry])

type GenesisSummary = API
    :&gt; &quot;genesis&quot;
    :&gt; &quot;summary&quot;
    :&gt; Get '[JSON] (Either ExplorerError CGenesisSummary)

type GenesisPagesTotal = API
    :&gt; &quot;genesis&quot;
    :&gt; &quot;address&quot;
    :&gt; &quot;pages&quot;
    :&gt; &quot;total&quot;
    :&gt; QueryParam &quot;pageSize&quot; Word
    :&gt; QueryParam &quot;filter&quot; CAddressesFilter
    :&gt; Get '[JSON] (Either ExplorerError PageNumber)

type GenesisAddressInfo = API
    :&gt; &quot;genesis&quot;
    :&gt; &quot;address&quot;
    :&gt; QueryParam &quot;page&quot; Word
    :&gt; QueryParam &quot;pageSize&quot; Word
    :&gt; QueryParam &quot;filter&quot; CAddressesFilter
    :&gt; Get '[JSON] (Either ExplorerError [CGenesisAddressInfo])

type TxsStats = (PageNumber, [(CTxId, Byte)])
type StatsTxs = API
    :&gt; &quot;stats&quot;
    :&gt; &quot;txs&quot;
    :&gt; QueryParam &quot;page&quot; Word
    :&gt; Get '[JSON] (Either ExplorerError TxsStats)

-- | Servant API which provides access to explorer
type ExplorerApi =
         TotalAda
    :&lt;|&gt; BlocksPages
    :&lt;|&gt; BlocksPagesTotal
    :&lt;|&gt; BlocksSummary
    :&lt;|&gt; BlocksTxs
    :&lt;|&gt; TxsLast
    :&lt;|&gt; TxsSummary
    :&lt;|&gt; AddressSummary
    :&lt;|&gt; EpochPages
    :&lt;|&gt; EpochSlots
    :&lt;|&gt; GenesisSummary
    :&lt;|&gt; GenesisPagesTotal
    :&lt;|&gt; GenesisAddressInfo
    :&lt;|&gt; StatsTxs

-- | Helper Proxy
explorerApi :: Proxy ExplorerApi
explorerApi = Proxy
</span></pre></body></html>